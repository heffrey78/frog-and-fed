<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Frog and The Fed | A Love Story Nobody Asked For</title>
    <meta name="description" content="When Portland's inflatable resistance met federal overreach, romance bloomed in the tear gas. The greatest love story of 2025.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --dark: #2d3748;
            --light: #f7fafc;
            --frog-green: #4ade80;
            --fed-gray: #64748b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px 20px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: drift 20s linear infinite;
            pointer-events: none;
        }

        @keyframes drift {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 1200px;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 8vw, 6rem);
            font-weight: 900;
            color: white;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            letter-spacing: -2px;
            animation: fadeInDown 1s ease-out;
        }

        .hero .subtitle {
            font-size: clamp(1.2rem, 3vw, 2rem);
            color: rgba(255,255,255,0.95);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 40px;
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        .hero-poster {
            max-width: 800px;
            width: 100%;
            margin: 40px auto;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            transition: transform 0.3s ease;
            animation: fadeIn 1s ease-out 0.6s both;
        }

        .hero-poster:hover {
            transform: scale(1.02) rotate(0.5deg);
        }

        .hero-poster img {
            width: 100%;
            height: auto;
            border-radius: 20px;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 40px;
            animation: fadeInUp 1s ease-out 0.9s both;
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: white;
            color: var(--primary);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: white;
            color: var(--primary);
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
            padding: 5px 10px;
        }

        nav a:hover {
            color: var(--accent);
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 20px;
        }

        .section {
            margin-bottom: 100px;
        }

        .section-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            color: white;
            text-align: center;
            margin-bottom: 60px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* Poster Gallery */
        .poster-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
        }

        .poster-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .poster-card:hover {
            transform: translateY(-10px) rotate(1deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .poster-image {
            width: 100%;
            height: 500px;
            position: relative;
            overflow: hidden;
        }

        .poster-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .poster-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 50%, rgba(255,255,255,0.1) 0%, transparent 50%);
        }

        .poster-emoji {
            font-size: 8rem;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .poster-title-overlay {
            font-size: 2.5rem;
            font-weight: 900;
            color: white;
            text-align: center;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            line-height: 1.2;
            position: relative;
            z-index: 1;
        }

        .poster-content {
            padding: 30px;
        }

        .poster-content h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .poster-content .tagline {
            font-style: italic;
            color: #666;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .poster-content p {
            color: #555;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tag {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Quote Section */
        .quote-carousel {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 900px;
            margin: 0 auto;
        }

        .quote-text {
            font-size: clamp(1.3rem, 3vw, 2rem);
            font-style: italic;
            color: var(--dark);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .quote-author {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 700;
        }

        .quote-nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .quote-nav button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .quote-nav button:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }

        /* VS Section */
        .vs-section {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .vs-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 40px;
            align-items: start;
        }

        .vs-side h3 {
            font-size: 2rem;
            margin-bottom: 30px;
            text-align: center;
        }

        .vs-side.trump {
            color: #dc3545;
        }

        .vs-side.portland {
            color: #28a745;
        }

        .vs-side ul {
            list-style: none;
        }

        .vs-side li {
            background: #f8f9fa;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            font-size: 1.1rem;
        }

        .vs-divider {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary);
            display: flex;
            align-items: center;
        }

        /* Interactive Frog */
        .interactive-frog {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 100px;
            height: 100px;
            background: var(--frog-green);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 999;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .interactive-frog:hover {
            transform: scale(1.2) rotate(360deg);
            background: #10b981;
        }

        .interactive-frog.active {
            animation: spin 0.5s linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.3); }
            100% { transform: rotate(360deg) scale(1); }
        }

        /* Meme Templates */
        .meme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .meme-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .meme-card:hover {
            transform: translateY(-5px);
        }

        .meme-card h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .meme-card p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .meme-card code {
            display: block;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            overflow-x: auto;
            color: var(--dark);
        }

        /* Stats Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .stat-card.counting {
            animation: statPulse 0.6s ease-in-out;
        }

        @keyframes statPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: 10px;
            position: relative;
        }

        .stat-number.counting {
            color: #ff6b35;
        }

        .stat-number.completed {
            animation: statComplete 0.8s ease-out;
        }

        @keyframes statComplete {
            0% { color: #ff6b35; transform: scale(1.1); }
            50% { color: #00d084; transform: scale(1.2); }
            100% { color: var(--primary); transform: scale(1); }
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
            font-weight: 600;
        }

        .stat-emoji-celebration {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            opacity: 0;
            pointer-events: none;
        }

        .stat-emoji-celebration.active {
            animation: emojiCelebration 1.5s ease-out;
        }

        @keyframes emojiCelebration {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
            }
            25% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
            }
            75% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1) rotate(360deg);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8) rotate(360deg);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .stat-card.counting,
            .stat-number.completed,
            .stat-emoji-celebration.active {
                animation: none;
            }
        }

        /* Timeline */
        /* Enhanced Interactive Timeline */
        .timeline {
            position: relative;
            padding: 40px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .timeline-item {
            display: flex;
            align-items: flex-start;
            margin: 60px 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .timeline-item:hover {
            transform: translateY(-5px);
        }

        .timeline-marker {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timeline-emoji {
            background: white;
            border: 4px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            animation: timelinePulse 2s ease-in-out infinite;
        }

        .timeline-item:hover .timeline-emoji {
            transform: scale(1.2);
            animation: timelineHover 0.6s ease-in-out infinite;
        }

        .timeline-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 45%;
            position: relative;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            margin-left: 0;
            margin-right: auto;
        }

        .timeline-item:nth-child(even) .timeline-content {
            margin-left: auto;
            margin-right: 0;
        }

        .timeline-content h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .timeline-content p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 0;
        }

        /* Timeline Hover Cards */
        .timeline-hover-card {
            position: absolute;
            top: -10px;
            background: var(--dark);
            color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 100;
            max-width: 280px;
        }

        .timeline-item:nth-child(odd) .timeline-hover-card {
            left: calc(100% + 20px);
        }

        .timeline-item:nth-child(even) .timeline-hover-card {
            right: calc(100% + 20px);
        }

        .timeline-item:hover .timeline-hover-card {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .emoji-mini-scene {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 10px;
            line-height: 1.2;
        }

        .timeline-hover-card p {
            margin: 0;
            font-size: 0.9rem;
            font-style: italic;
            text-align: center;
        }

        /* Timeline Animations */
        @keyframes timelinePulse {
            0%, 100% {
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            }
            50% {
                box-shadow: 0 4px 25px rgba(102, 126, 234, 0.4);
            }
        }

        @keyframes timelineHover {
            0%, 100% {
                transform: scale(1.2) rotate(0deg);
            }
            50% {
                transform: scale(1.3) rotate(5deg);
            }
        }

        /* Interactive Timeline Controls */
        .timeline-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .timeline-mode-btn {
            background: linear-gradient(135deg, var(--primary), #4ade80);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .timeline-mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .timeline-mode-btn.active {
            background: linear-gradient(135deg, #ff6b35, #f59e0b);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        /* Interactive Timeline Items */
        .interactive-timeline-item {
            cursor: pointer;
            position: relative;
        }

        .interactive-timeline-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(255, 107, 53, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 15px;
            pointer-events: none;
        }

        .interactive-timeline-item:hover::after {
            opacity: 1;
        }

        .timeline-click-hint {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0;
            transition: all 0.3s ease;
            white-space: nowrap;
            z-index: 10;
        }

        .interactive-timeline-item:hover .timeline-click-hint {
            opacity: 1;
            bottom: -25px;
        }

        @media (max-width: 768px) {
            .timeline-controls {
                flex-direction: column;
                align-items: center;
            }

            .timeline-mode-btn {
                width: 100%;
                max-width: 280px;
            }

            .timeline-click-hint {
                position: static;
                transform: none;
                margin-top: 10px;
                opacity: 1;
                bottom: auto;
            }
        }

        /* Story Modal Styles */
        .story-modal-content {
            max-width: 600px;
            margin: 5% auto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            overflow: hidden;
        }

        .story-content {
            padding: 30px;
        }

        .story-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .story-emoji {
            font-size: 4rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        .story-title {
            font-size: 2rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .story-body {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .story-narrative {
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .story-narrative p {
            margin-bottom: 15px;
        }

        .story-narrative strong {
            color: #ffd700;
        }

        .story-choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .story-choice-btn {
            background: linear-gradient(135deg, #ff6b35, #f59e0b);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .story-choice-btn:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
            .story-modal-content {
                margin: 10% 15px;
            }

            .story-content {
                padding: 20px;
            }

            .story-emoji {
                font-size: 3rem;
            }

            .story-title {
                font-size: 1.5rem;
            }
        }

        /* Character Modal Styles */
        .character-modal-content {
            max-width: 700px;
            margin: 3% auto;
            background: linear-gradient(135deg, #ff6b35 0%, #f59e0b 100%);
            color: white;
            border-radius: 20px;
            overflow: hidden;
        }

        .character-profile {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            padding: 30px;
        }

        .character-avatar {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .character-emoji {
            font-size: 5rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        .character-name {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .character-role {
            font-size: 1rem;
            opacity: 0.9;
            font-style: italic;
        }

        .character-details {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .character-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .stat-label {
            font-weight: 600;
            opacity: 0.8;
        }

        .stat-value {
            color: #ffd700;
            font-weight: bold;
        }

        .character-backstory,
        .character-personality,
        .character-quote {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
        }

        .character-backstory h4,
        .character-personality h4,
        .character-quote h4 {
            margin: 0 0 10px 0;
            font-size: 1.2rem;
            color: #ffd700;
        }

        .backstory-text,
        .personality-text {
            margin: 0;
            line-height: 1.5;
        }

        .quote-text {
            margin: 0;
            font-style: italic;
            font-size: 1.1rem;
            border-left: 4px solid #ffd700;
            padding-left: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            padding: 10px 15px;
        }

        .character-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .character-action-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .character-action-btn:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        @media (max-width: 768px) {
            .character-modal-content {
                margin: 5% 10px;
            }

            .character-profile {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }

            .character-emoji {
                font-size: 4rem;
            }

            .character-name {
                font-size: 1.5rem;
            }
        }

        /* Meme Generator Styles */
        .meme-generator-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .meme-canvas-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        #memeCanvas {
            width: 100%;
            height: auto;
            max-width: 800px;
            border: 3px solid #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            cursor: crosshair;
        }

        .meme-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1rem;
        }

        #templateSelect,
        #topText,
        #bottomText {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        #templateSelect:focus,
        #topText:focus,
        #bottomText:focus {
            border-color: var(--primary);
            outline: none;
        }

        .emoji-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .emoji-btn {
            font-size: 2rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
            user-select: none;
        }

        .emoji-btn:hover {
            background: var(--primary);
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .meme-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .meme-btn {
            background: linear-gradient(135deg, var(--primary), #4ade80);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .meme-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .meme-gallery {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            height: fit-content;
        }

        .meme-gallery h3 {
            margin: 0 0 20px 0;
            text-align: center;
            font-size: 1.5rem;
        }

        .featured-memes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .featured-meme {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .featured-meme img {
            width: 100%;
            max-width: 200px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .featured-meme .meme-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .featured-meme .meme-stats {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .meme-generator-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .meme-canvas-container {
                padding: 20px;
            }

            #memeCanvas {
                width: 100%;
                height: auto;
            }

            .meme-actions {
                grid-template-columns: 1fr;
            }

            .emoji-palette {
                justify-content: center;
            }

            .emoji-btn {
                font-size: 1.5rem;
            }
        }

        /* Easter Egg Styles */
        .easter-egg-notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b35, #f59e0b);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
            z-index: 10000;
            transform: translateX(400px);
            transition: transform 0.5s ease;
            max-width: 300px;
        }

        .easter-egg-notification.show {
            transform: translateX(0);
        }

        .notification-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .notification-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: #ffd700;
        }

        .notification-description {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .notification-progress {
            font-size: 0.8rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 10px;
        }

        .easter-egg-modal {
            max-width: 600px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
        }

        .easter-egg-modal h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        .discovery-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .discovery-item {
            display: grid;
            grid-template-columns: 50px 1fr;
            gap: 15px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            align-items: center;
        }

        .discovery-item.discovered {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid #ffd700;
        }

        .discovery-icon {
            font-size: 2rem;
            text-align: center;
        }

        .discovery-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .discovery-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .easter-egg-hints {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
        }

        .easter-egg-hints h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .easter-egg-hints ul {
            margin: 0;
            padding-left: 20px;
        }

        .easter-egg-hints li {
            margin-bottom: 8px;
            opacity: 0.9;
        }

        .tracker-separator {
            margin: 0 8px;
            opacity: 0.5;
        }

        .stats-btn {
            cursor: pointer;
            text-decoration: underline;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .stats-btn:hover {
            opacity: 1;
        }

        /* Engagement Dashboard Styles */
        .engagement-modal {
            max-width: 800px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 20px;
        }

        .engagement-modal h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        .engagement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .engagement-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .engagement-number {
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .engagement-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .engagement-breakdown,
        .engagement-activity {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .engagement-breakdown h3,
        .engagement-activity h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #ffd700;
        }

        .time-breakdown-item {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-name {
            font-weight: 600;
        }

        .time-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
        }

        .time-fill {
            background: linear-gradient(90deg, #ffd700, #f59e0b);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .time-value {
            text-align: right;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .activity-item {
            display: grid;
            grid-template-columns: 30px 1fr auto;
            gap: 12px;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-emoji {
            font-size: 1.2rem;
        }

        .activity-description {
            font-size: 0.9rem;
        }

        .activity-time {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .no-activity {
            text-align: center;
            opacity: 0.7;
            padding: 20px;
            font-style: italic;
        }

        .engagement-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .engagement-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .engagement-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .engagement-btn.reset {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .engagement-btn.reset:hover {
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }

        @media (max-width: 768px) {
            .easter-egg-notification {
                right: 10px;
                left: 10px;
                max-width: none;
                transform: translateY(-400px);
            }

            .easter-egg-notification.show {
                transform: translateY(0);
            }

            #easter-egg-tracker {
                top: 10px !important;
                right: 10px !important;
                font-size: 0.8rem !important;
            }

            .engagement-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .time-breakdown-item {
                grid-template-columns: 1fr;
                gap: 8px;
                text-align: center;
            }

            .engagement-actions {
                flex-direction: column;
            }
        }

        /* Games Section Styles */
        .games-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .game-launcher {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .game-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .game-card.coming-soon {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .game-card.coming-soon:hover {
            transform: none;
            box-shadow: none;
        }

        .game-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        .game-card h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .game-card p {
            font-size: 1rem;
            margin-bottom: 20px;
            opacity: 0.9;
            line-height: 1.5;
        }

        .game-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 20px;
        }

        .high-score {
            font-weight: 600;
            color: #ffd700;
        }

        .game-play-btn {
            background: linear-gradient(135deg, #ff6b35, #f59e0b);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .game-play-btn:hover {
            background: linear-gradient(135deg, #f59e0b, #ff6b35);
            transform: scale(1.05);
        }

        .coming-soon-badge {
            position: absolute;
            top: 20px;
            right: -30px;
            background: #ef4444;
            color: white;
            padding: 5px 40px;
            transform: rotate(45deg);
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Game Modal Styles */
        .game-modal {
            z-index: 10000;
        }

        .game-modal-content {
            max-width: 900px;
            margin: 2% auto;
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            color: white;
            border-radius: 20px;
            overflow: hidden;
        }

        .game-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .game-header h2 {
            margin: 0;
            font-size: 2rem;
        }

        .game-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .game-score,
        .game-lives {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        .game-close-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .game-area {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            padding: 30px;
        }

        #frogPongCanvas {
            border: 3px solid #667eea;
            border-radius: 10px;
            background: #000;
            width: 100%;
            height: auto;
            max-width: 800px;
        }

        .game-ui {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .game-instructions {
            margin-bottom: 25px;
        }

        .game-instructions h4,
        .game-power-ups h4 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .game-instructions p {
            margin: 8px 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .power-up-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .power-up {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .game-footer {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .game-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }

        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .game-launcher {
                grid-template-columns: 1fr;
            }

            .game-modal-content {
                margin: 5% 10px;
            }

            .game-area {
                grid-template-columns: 1fr;
            }

            .game-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .game-controls {
                flex-wrap: wrap;
                justify-content: center;
            }

            .game-footer {
                flex-wrap: wrap;
            }

            #frogPongCanvas {
                width: 100%;
                height: auto;
            }
        }

        /* Footer */
        footer {
            background: rgba(0,0,0,0.9);
            color: white;
            text-align: center;
            padding: 60px 20px;
            margin-top: 100px;
        }

        footer h3 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        footer p {
            font-size: 1.1rem;
            margin: 10px 0;
            opacity: 0.9;
        }

        footer .credits {
            margin-top: 40px;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* Close button styles */
        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 32px;
            font-weight: bold;
            color: #ccc;
            cursor: pointer;
            z-index: 1001;
            line-height: 1;
            transition: all 0.3s ease;
        }

        .close:hover {
            color: var(--primary);
            transform: scale(1.1);
        }

        /* Modal content styles */
        .modal-content {
            position: relative;
            background: var(--dark);
            color: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .engagement-modal {
            width: 600px;
            max-width: 90vw;
            background: var(--dark);
        }

        .story-modal-content {
            width: 700px;
            max-width: 90vw;
            background: var(--dark);
        }

        /* Engagement modal specific styles */
        .engagement-modal h2 {
            color: var(--primary);
            margin-bottom: 20px;
        }

        .engagement-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .engagement-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .engagement-btn.reset {
            background: #dc2626;
        }

        .engagement-btn.reset:hover {
            background: #b91c1c;
        }

        /* Story modal specific styles */
        .story-content h3 {
            color: var(--primary);
        }

        .story-choice-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .story-choice-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        /* Romance Simulator Styles */
        .romance-modal-content {
            width: 900px;
            max-width: 95vw;
            background: var(--dark);
            color: white;
        }

        .romance-game-area {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .romance-scene {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 15px;
            padding: 20px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
        }

        .scene-background {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(45deg, rgba(255,192,203,0.1), rgba(135,206,235,0.1));
            border-radius: 10px;
        }

        .scene-characters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 200px;
            padding: 0 40px;
        }

        .character {
            font-size: 4rem;
            transition: all 0.3s ease;
            cursor: pointer;
            text-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        .character-frog:hover {
            transform: scale(1.1) rotate(10deg);
        }

        .character-fed:hover {
            transform: scale(1.1) rotate(-10deg);
        }

        .scene-effects {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .romance-stats {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .stat-bar {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .stat-bar-container {
            flex: 1;
            height: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .romance-bar {
            background: linear-gradient(90deg, #ff69b4, #ff1493);
        }

        .tension-bar {
            background: linear-gradient(90deg, #ff4500, #dc143c);
        }

        .understanding-bar {
            background: linear-gradient(90deg, #32cd32, #228b22);
        }

        .romance-info {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
        }

        .story-display {
            grid-column: 1 / -1;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
        }

        .story-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
            min-height: 80px;
        }

        .character-speaking {
            font-style: italic;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .choice-buttons {
            grid-column: 1 / -1;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .choice-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
        }

        .choice-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .choice-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .romance-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .romance-controls button {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .romance-controls button:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-1px);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .romance-game-area {
                grid-template-columns: 1fr;
            }

            .scene-characters {
                padding: 0 20px;
            }

            .character {
                font-size: 3rem;
            }

            .choice-btn {
                min-width: 150px;
            }
        }

        /* Enhanced Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content-enhanced {
            background: white;
            border-radius: 20px;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal-top-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 400px;
        }

        .modal-poster-section {
            background: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-poster-section img {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 10px;
        }

        .modal-emoji-scene {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .emoji-animation-container {
            font-size: 3rem;
            line-height: 1.2;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .emoji-heart {
            animation: heartBeat 2s ease-in-out infinite;
            display: inline-block;
        }

        .emoji-float {
            animation: romanticFloat 4s ease-in-out infinite;
            display: inline-block;
        }

        .emoji-bounce {
            animation: gentleBounce 3s ease-in-out infinite;
            display: inline-block;
        }

        .scene-caption {
            color: white;
            font-style: italic;
            text-align: center;
            margin-top: 20px;
            font-size: 1.1rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .modal-bottom-section {
            padding: 40px;
            background: var(--light);
            border-radius: 0 0 20px 20px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: white;
            transition: all 0.3s ease;
            z-index: 10;
            background: rgba(0,0,0,0.5);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        /* Emoji Animations */
        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes romanticFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(2deg); }
            50% { transform: translateY(-15px) rotate(0deg); }
            75% { transform: translateY(-5px) rotate(-2deg); }
        }

        @keyframes gentleBounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        /* Hero Particle System */
        .hero-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .weather-effects {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
            overflow: hidden;
        }

        .weather-particle {
            position: absolute;
            font-size: 1.5rem;
            animation: weatherFall 6s linear infinite;
            opacity: 0.7;
        }

        .poster-glow {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.3) 0%, transparent 70%);
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .hero-poster:hover .poster-glow {
            opacity: 1;
            animation: pulseGlow 2s ease-in-out infinite;
        }

        .hero-poster {
            position: relative;
            z-index: 3;
        }

        /* Weather Animations */
        @keyframes weatherFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes pulseGlow {
            0%, 100% {
                transform: scale(1);
                opacity: 0.3;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.6;
            }
        }

        /* Enhanced Hero Interactions */
        .hero-poster img {
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        .hero-poster:hover img {
            transform: scale(1.02);
            filter: brightness(1.1) saturate(1.1);
        }

        .hero-content {
            position: relative;
            z-index: 3;
        }

        /* Particle Performance Optimization */
        @media (prefers-reduced-motion: reduce) {
            .hero-particles,
            .weather-effects {
                display: none;
            }

            .poster-glow {
                animation: none;
            }

            .hero-poster:hover img {
                transform: none;
            }
        }

        /* Responsive Modal */
        @media (max-width: 768px) {
            .modal-top-section {
                grid-template-columns: 1fr;
            }

            .modal-content-enhanced {
                max-width: 95vw;
                margin: 10px;
            }

            .emoji-animation-container {
                font-size: 2rem;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            nav ul {
                gap: 15px;
                padding: 0 20px;
            }

            nav a {
                font-size: 0.9rem;
            }

            .poster-grid {
                grid-template-columns: 1fr;
            }

            .vs-container {
                grid-template-columns: 1fr;
            }

            .vs-divider {
                transform: rotate(90deg);
                margin: 20px 0;
            }

            /* Mobile Timeline */
            .timeline::before {
                left: 30px;
            }

            .timeline-item {
                margin: 40px 0;
            }

            .timeline-marker {
                left: 30px;
                transform: none;
            }

            .timeline-emoji {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .timeline-content {
                width: calc(100% - 80px);
                margin-left: 80px !important;
                margin-right: 0 !important;
            }

            .timeline-hover-card {
                position: static;
                opacity: 1;
                visibility: visible;
                transform: none;
                margin-top: 15px;
                background: var(--accent);
                max-width: none;
            }

            .timeline-item:nth-child(odd) .timeline-hover-card,
            .timeline-item:nth-child(even) .timeline-hover-card {
                left: auto;
                right: auto;
            }

            .interactive-frog {
                width: 80px;
                height: 80px;
                font-size: 2.5rem;
                bottom: 20px;
                right: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            /* Mobile Particle Optimizations */
            .weather-particle {
                font-size: 1.2rem;
            }

            .hero-poster img {
                transition: transform 0.2s ease;
            }

            .hero-poster:hover img {
                transform: scale(1.01);
            }

            .poster-glow {
                animation-duration: 3s;
            }
        }

        /* Easter Egg */
        .easter-egg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 9999;
        }

        .easter-egg.show {
            opacity: 1;
            animation: explode 1s ease-out;
        }

        @keyframes explode {
            0% {
                transform: translate(-50%, -50%) scale(0) rotate(0deg);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.5) rotate(180deg);
            }
            100% {
                transform: translate(-50%, -50%) scale(1) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="#hero">Home</a></li>
            <li><a href="#posters">Posters</a></li>
            <li><a href="#quotes">Quotes</a></li>
            <li><a href="#story">The Story</a></li>
            <li><a href="#meme-generator">Meme Generator</a></li>
            <li><a href="#games">Games</a></li>
            <li><a href="#memes">Meme Templates</a></li>
            <li><a href="#stats">Stats</a></li>
        </ul>
    </nav>

    <div class="hero" id="hero">
        <!-- Particle System Canvas -->
        <canvas class="hero-particles" id="particleCanvas"></canvas>

        <!-- Weather Effects -->
        <div class="weather-effects" id="weatherEffects"></div>

        <div class="hero-content">
            <h1>🐸 The Frog and The Fed 💕</h1>
            <p class="subtitle">A love story nobody asked for. A romance nobody could prevent.</p>

            <div class="hero-poster" id="heroPoster">
                <img src="assets/frog-and-fed-notebook.png" alt="The Frog and The Fed Movie Poster">
                <div class="poster-glow"></div>
            </div>

            <div class="cta-buttons">
                <a href="#posters" class="btn btn-primary">Explore All Posters</a>
                <a href="#story" class="btn btn-secondary">Read The Story</a>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Posters Section -->
        <section class="section" id="posters">
            <h2 class="section-title">The Complete Collection</h2>
            <div class="poster-grid">
                <div class="poster-card" onclick="showModal('notebook')">
                    <div class="poster-image">
                        <img src="assets/frog-and-fed-notebook.png" alt="The Frog and The Fed Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>The Notebook Style</h3>
                        <p class="tagline">"But love... love is inflatable."</p>
                        <p>Iconic rain scene recreation. Federal agent in tactical gear reaching toward inflatable frog in Portland downpour. Pepper spray canister dropped in puddle between them.</p>
                        <div class="tags">
                            <span class="tag">Viral Gold</span>
                            <span class="tag">Actually Happened</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('sally')">
                    <div class="poster-image">
                        <img src="assets/when-riot-met-sally.png" alt="When Riot Met Sally Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>When Harry Met Sally Parody</h3>
                        <p class="tagline">"Can a fed and a frog be just friends?"</p>
                        <p>Split-screen diner scene. Federal agent in tactical gear at café table. Inflatable frog squeezed into booth across from him. Voodoo Doughnut visible through window.</p>
                        <div class="tags">
                            <span class="tag">Rom-Com Energy</span>
                            <span class="tag">Portland AF</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('titanic')">
                    <div class="poster-image">
                        <img src="assets/titanic-portand.png" alt="Titanic Portland Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Titanic: The Portland Remix</h3>
                        <p class="tagline">"Draw me like one of your French frogs"</p>
                        <p>King of the world pose on Portland's Steel Bridge. Federal agent behind frog, both arms outstretched. ICE facility sinking dramatically in background.</p>
                        <div class="tags">
                            <span class="tag">Classic</span>
                            <span class="tag">Metaphorically Accurate</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('star')">
                    <div class="poster-image">
                        <img src="assets/star-is-inflated.png" alt="A Star Is Inflated Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>A Star Is Born</h3>
                        <p class="tagline">"Sometimes you find your voice in the most unexpected places"</p>
                        <p>Concert stage aesthetic. Frog in spotlight singing. Federal agent watching from crowd with awe. Banana Bloc band visible in background.</p>
                        <div class="tags">
                            <span class="tag">Musical</span>
                            <span class="tag">Banana Bloc Approved</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('fault')">
                    <div class="poster-image">
                        <img src="assets/fault-in-our-teargas.png" alt="The Fault In Our Teargas Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>The Fault In Our Stars</h3>
                        <p class="tagline">"Okay? Okay."</p>
                        <p>Tender close-up. Federal agent (mask removed) touching frog's face. Googly eyes staring back. Tear gas clouds forming heart shape in background.</p>
                        <div class="tags">
                            <span class="tag">Emotional</span>
                            <span class="tag">Some Infinities Are Inflatable</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('pride')">
                    <div class="poster-image">
                        <img src="assets/pride-and-pepperspray.png" alt="Pride and Pepper Spray Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Pride and Prejudice</h3>
                        <p class="tagline">"You have bewitched me, body and googly-eyed soul"</p>
                        <p>Period piece aesthetic but modern. Fed in tactical gear looking brooding in misty Portland park. Frog approaching through fog, backlit.</p>
                        <div class="tags">
                            <span class="tag">Jane Austen Would Approve</span>
                            <span class="tag">Constitutional Drama</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('eternal')">
                    <div class="poster-image">
                        <img src="assets/eternal-sunshine-protest.png" alt="Eternal Sunshine of the Spotless Mind Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Eternal Sunshine</h3>
                        <p class="tagline">"Meet me in Portland"</p>
                        <p>Surreal, dreamlike aesthetic. Fed and frog running through literally erasing Portland landscape. Holding hands. Objects floating. Whimsical chaos.</p>
                        <div class="tags">
                            <span class="tag">Mind-Bending</span>
                            <span class="tag">Memory Hole Approved</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('lady')">
                    <div class="poster-image">
                        <img src="assets/lady-and-tactical-response.png" alt="Lady and the Tramp Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Lady and the Tramp</h3>
                        <p class="tagline">"Bella notte... full of tear gas"</p>
                        <p>Spaghetti kiss scene but weird. Fed and frog on opposite ends of protest banner. Romantic Italian lighting. Banana Bloc accordion player.</p>
                        <div class="tags">
                            <span class="tag">Disney Classic</span>
                            <span class="tag">This Is Bananas</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('ghost')">
                    <div class="poster-image">
                        <img src="assets/ghost-portland.png" alt="Ghost Portland Cut Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Ghost</h3>
                        <p class="tagline">"Ditto" - The Frog, probably</p>
                        <p>Pottery wheel scene but unhinged. Fed standing behind frog at protest sign-making station. Both molding clay sign. Bob Ross painting in background.</p>
                        <div class="tags">
                            <span class="tag">Unchained Melody</span>
                            <span class="tag">Crafts & Resistance</span>
                        </div>
                    </div>
                </div>

                <div class="poster-card" onclick="showModal('fifty')">
                    <div class="poster-image">
                        <img src="assets/fifty-shades-pepperspray.png" alt="Fifty Shades of Pepper Spray Movie Poster">
                    </div>
                    <div class="poster-content">
                        <h3>Fifty Shades</h3>
                        <p class="tagline">"Mr. Fed will see you now"</p>
                        <p>Steamy but absurd. Fed leaning against ICE building, looming over frog. Googly eyes looking up. Pepper spray canister dangling suggestively.</p>
                        <div class="tags">
                            <span class="tag">Red Room = Protest Zone</span>
                            <span class="tag">Constitutional Boundaries</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quotes Section -->
        <section class="section" id="quotes">
            <h2 class="section-title">Legendary Quotes</h2>
            <div class="quote-carousel">
                <div class="quote-text" id="quote-text">
                    "I've definitely had spicier tamales."
                </div>
                <div class="quote-author" id="quote-author">
                    — Seth Todd, after being pepper-sprayed inside his frog costume
                </div>
                <div class="quote-nav">
                    <button onclick="previousQuote()">← Previous</button>
                    <button onclick="nextQuote()">Next →</button>
                    <button onclick="randomQuote()">🎲 Random</button>
                </div>
            </div>
        </section>

        <!-- VS Section -->
        <section class="section">
            <h2 class="section-title">The Great Contrast</h2>
            <div class="vs-section">
                <div class="vs-container">
                    <div class="vs-side trump">
                        <h3>Trump's Claims</h3>
                        <ul>
                            <li>🔥 "War-ravaged"</li>
                            <li>💣 "Beehive of terrorists"</li>
                            <li>🏴 "Anarchist jurisdiction"</li>
                            <li>💥 "Explosive fire-ridden warland"</li>
                            <li>🚫 "No sewers anymore"</li>
                            <li>⚔️ "Under siege for 47 days"</li>
                            <li>🏚️ "Bombed out"</li>
                        </ul>
                    </div>
                    <div class="vs-divider">VS</div>
                    <div class="vs-side portland">
                        <h3>Actual Portland</h3>
                        <ul>
                            <li>🐸 Dancing frogs</li>
                            <li>🦖 Inflatable dinosaurs</li>
                            <li>🍌 Banana marching band</li>
                            <li>🎨 Bob Ross painting</li>
                            <li>🎲 Twister games</li>
                            <li>🫧 Bubble blowing</li>
                            <li>🍕 Pizza distribution</li>
                            <li>📚 Public book readings</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Story Timeline -->
        <section class="section" id="story">
            <h2 class="section-title">The Love Story: An Interactive Timeline</h2>
            <div class="timeline-controls">
                <button class="timeline-mode-btn active" data-mode="story">📖 Love Story Mode</button>
                <button class="timeline-mode-btn" data-mode="documentary">📰 Documentary Mode</button>
                <button class="timeline-mode-btn" data-mode="characters">👥 Character Focus</button>
            </div>
            <div class="timeline">
                <div class="timeline-item interactive-timeline-item" data-emoji="🐸" data-scene="👤➡️🐸" data-caption="The first frog appears" data-character="seth" data-story-id="beginning" onclick="openTimelineStory(this)">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">🐸</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>June 2025: The Beginning</h4>
                        <p>Seth Todd, 24, starts wearing a green inflatable frog costume to ICE facility protests. His mission: show how ridiculous the "violent terrorist" narrative is.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">👤➡️🐸</div>
                            <p>"Time to get silly with authoritarianism"</p>
                        </div>
                        <div class="timeline-click-hint">🎬 Click to explore Seth's origin story</div>
                    </div>
                </div>

                <div class="timeline-item" data-emoji="🌶️" data-scene="🐸🌶️👮‍♂️😤" data-caption="Spicy situation">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">🌶️</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>October 2-4, 2025: The Pepper Spray Incident</h4>
                        <p>A federal agent deliberately pepper-sprays Todd's frog costume by shooting spray into the air intake vent. Todd's response: "I've definitely had spicier tamales." The video gets 1.5 million likes on TikTok.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">🐸🌶️👮‍♂️😤</div>
                            <p>"I've had spicier tamales" - The quote heard 'round the world</p>
                        </div>
                    </div>
                </div>

                <div class="timeline-item" data-emoji="🎈" data-scene="🌐➡️🐸🐸🐸" data-caption="Inflation economics">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">🎈</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>Operation Inflation Launches</h4>
                        <p>Brooks Brown and Jordy Johnson create OperationInflation.com to crowdfund and distribute free inflatable costumes. Within days, they distribute 75-100 costumes.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">🌐➡️🐸🐸🐸</div>
                            <p>Economics: One website + One idea = Infinite frogs</p>
                        </div>
                    </div>
                </div>

                <div class="timeline-item" data-emoji="🦄" data-scene="🐸🦖🦄🐿️🍌" data-caption="Zoo arrives">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">🦄</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>The Menagerie Arrives</h4>
                        <p>Frogs multiply. Dinosaurs appear. Unicorns start twerking. The Banana Bloc marching band performs. SpongeBob, Pikachu, and Cookie Monster join the protest.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">🐸🦖🦄🐿️🍌</div>
                            <p>Portland's wildest parade disguised as a protest</p>
                        </div>
                    </div>
                </div>

                <div class="timeline-item" data-emoji="📸" data-scene="📸💥😂🌍" data-caption="Photo op backfires">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">📸</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>October 7: The Viral Moment</h4>
                        <p>DHS Secretary Kristi Noem stages rooftop photo op. Someone plays "Yakety Sax." Jack Dickinson's chicken suit is in frame. The internet explodes with mockery.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">📸💥😂🌍</div>
                            <p>When your serious photo op becomes a meme format</p>
                        </div>
                    </div>
                </div>

                <div class="timeline-item" data-emoji="💕" data-scene="🐸+👮‍♂️=❤️" data-caption="Love conquers all">
                    <div class="timeline-marker">
                        <span class="timeline-emoji">💕</span>
                        <div class="timeline-line"></div>
                    </div>
                    <div class="timeline-content">
                        <h4>The Legacy</h4>
                        <p>Portland proved that joy is resistance, that absurdism defeats authoritarianism, and that sometimes the best way to fight fear-mongering is with a dancing frog in googly eyes.</p>
                        <div class="timeline-hover-card">
                            <div class="emoji-mini-scene">🐸+👮‍♂️=❤️</div>
                            <p>The greatest love story nobody asked for</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="section" id="stats">
            <h2 class="section-title">By The Numbers</h2>
            <div class="stats-grid">
                <div class="stat-card" data-target="1500000" data-suffix="" data-emoji="🐸">
                    <div class="stat-number">1.5M</div>
                    <div class="stat-label">TikTok Likes on Frog Video</div>
                    <div class="stat-emoji-celebration">🐸</div>
                </div>
                <div class="stat-card" data-target="150" data-suffix="+" data-emoji="👗">
                    <div class="stat-number">150+</div>
                    <div class="stat-label">Costumes Distributed</div>
                    <div class="stat-emoji-celebration">👗</div>
                </div>
                <div class="stat-card" data-target="200" data-suffix="+" data-emoji="👮‍♂️">
                    <div class="stat-number">200+</div>
                    <div class="stat-label">National Guard Deployed (vs. Dancing Animals)</div>
                    <div class="stat-emoji-celebration">👮‍♂️</div>
                </div>
                <div class="stat-card" data-target="0" data-suffix="" data-emoji="☮️">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Actual Violent Incidents</div>
                    <div class="stat-emoji-celebration">☮️</div>
                </div>
                <div class="stat-card" data-target="1" data-suffix="" data-emoji="🐔">
                    <div class="stat-number">1</div>
                    <div class="stat-label">Legendary Chicken Suit</div>
                    <div class="stat-emoji-celebration">🐔</div>
                </div>
                <div class="stat-card" data-target="∞" data-suffix="" data-emoji="💥">
                    <div class="stat-number">∞</div>
                    <div class="stat-label">Meme Potential</div>
                    <div class="stat-emoji-celebration">💥</div>
                </div>
            </div>
        </section>

        <!-- Interactive Meme Generator -->
        <section class="section" id="meme-generator">
            <h2 class="section-title">🎨 Create Your Own Memes</h2>
            <div class="meme-generator-container">
                <div class="meme-canvas-container">
                    <canvas id="memeCanvas" width="800" height="600"></canvas>
                    <div class="meme-controls">
                        <div class="control-group">
                            <label>Choose Template:</label>
                            <select id="templateSelect">
                                <option value="drake">Drake Pointing</option>
                                <option value="distracted">Distracted Boyfriend</option>
                                <option value="buttons">Two Buttons</option>
                                <option value="fine">This Is Fine</option>
                                <option value="poster">Movie Poster Style</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Top Text:</label>
                            <input type="text" id="topText" placeholder="Enter top text..." maxlength="100">
                        </div>
                        <div class="control-group">
                            <label>Bottom Text:</label>
                            <input type="text" id="bottomText" placeholder="Enter bottom text..." maxlength="100">
                        </div>
                        <div class="control-group">
                            <label>Add Emojis:</label>
                            <div class="emoji-palette">
                                <span class="emoji-btn" onclick="addEmoji('🐸')">🐸</span>
                                <span class="emoji-btn" onclick="addEmoji('👮‍♂️')">👮‍♂️</span>
                                <span class="emoji-btn" onclick="addEmoji('💕')">💕</span>
                                <span class="emoji-btn" onclick="addEmoji('🌶️')">🌶️</span>
                                <span class="emoji-btn" onclick="addEmoji('🎭')">🎭</span>
                                <span class="emoji-btn" onclick="addEmoji('💥')">💥</span>
                                <span class="emoji-btn" onclick="addEmoji('😂')">😂</span>
                                <span class="emoji-btn" onclick="addEmoji('🔥')">🔥</span>
                            </div>
                        </div>
                        <div class="meme-actions">
                            <button class="meme-btn" onclick="generateMeme()">🎨 Generate Meme</button>
                            <button class="meme-btn" onclick="downloadMeme()">💾 Download</button>
                            <button class="meme-btn" onclick="shareToSocial()">📱 Share</button>
                            <button class="meme-btn" onclick="randomizeMeme()">🎲 Surprise Me!</button>
                        </div>
                    </div>
                </div>
                <div class="meme-gallery">
                    <h3>🏆 Community Creations</h3>
                    <div class="featured-memes" id="featuredMemes">
                        <!-- Featured memes will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Mini-Games Section -->
        <section class="section" id="games">
            <h2 class="section-title">🎮 Frog & Fed Games</h2>
            <div class="games-container">
                <div class="game-launcher">
                    <div class="game-card" onclick="launchFrogPong()">
                        <div class="game-icon">🐸🏓</div>
                        <h3>Frog Pong</h3>
                        <p>Bounce the inflatable frog between riot shields! Can you achieve peaceful pong?</p>
                        <div class="game-stats">
                            <span class="high-score">High Score: <span id="frogPongHighScore">0</span></span>
                        </div>
                        <button class="game-play-btn">🎮 Play Now</button>
                    </div>
                    <div class="game-card" onclick="launchTetris()">
                        <div class="game-icon">🌶️📦</div>
                        <h3>Tear Gas Tetris</h3>
                        <p>Stack protective gear to survive the chaos! Build your defense piece by piece.</p>
                        <div class="game-stats">
                            <span class="high-score">High Score: <span id="tetrisHighScore">0</span></span>
                        </div>
                        <button class="game-play-btn">🎮 Play Now</button>
                    </div>
                    <div class="game-card">
                        <div class="game-icon">💕📖</div>
                        <h3>Romance Simulator</h3>
                        <p>Navigate the complex relationship between Frog and Fed in this branching story.</p>
                        <div class="game-stats">
                            <span class="high-score">Best Ending: <span id="romanceHighScore">None</span></span>
                        </div>
                        <button class="game-play-btn" onclick="launchRomanceSimulator()">🎮 Play Now</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Frog Pong Game Modal -->
        <div id="frogPongModal" class="modal game-modal">
            <div class="modal-content game-modal-content">
                <div class="game-header">
                    <h2>🐸🏓 Frog Pong</h2>
                    <div class="game-controls">
                        <div class="game-score">Score: <span id="gameScore">0</span></div>
                        <div class="game-lives">Lives: <span id="gameLives">3</span></div>
                        <button onclick="closeFrogPong()" class="game-close-btn">✕ Close</button>
                    </div>
                </div>
                <div class="game-area">
                    <canvas id="frogPongCanvas" width="800" height="400"></canvas>
                    <div class="game-ui">
                        <div class="game-instructions">
                            <p><strong>Controls:</strong></p>
                            <p>🖱️ <strong>Mouse:</strong> Move paddle up/down</p>
                            <p>📱 <strong>Touch:</strong> Tap and drag paddle</p>
                            <p>⌨️ <strong>Keys:</strong> W/S or ↑/↓ arrows</p>
                        </div>
                        <div class="game-power-ups">
                            <h4>Power-ups:</h4>
                            <div class="power-up-list">
                                <span class="power-up">💕 Heart - Extra life</span>
                                <span class="power-up">🌶️ Spicy - Speed boost</span>
                                <span class="power-up">👁️ Googly - Bigger paddle</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="game-footer">
                    <button onclick="startFrogPong()" class="game-btn" id="startGameBtn">🎮 Start Game</button>
                    <button onclick="pauseFrogPong()" class="game-btn" id="pauseGameBtn" style="display:none;">⏸️ Pause</button>
                    <button onclick="resetFrogPong()" class="game-btn">🔄 Reset</button>
                </div>
            </div>
        </div>

        <!-- Tear Gas Tetris Game Modal -->
        <div id="tetrisModal" class="modal game-modal">
            <div class="modal-content game-modal-content">
                <div class="game-header">
                    <h2>🌶️📦 Tear Gas Tetris</h2>
                    <div class="game-controls">
                        <div class="game-score">Score: <span id="tetrisScore">0</span></div>
                        <div class="game-level">Level: <span id="tetrisLevel">1</span></div>
                        <div class="game-lines">Lines: <span id="tetrisLines">0</span></div>
                        <button onclick="closeTetris()" class="game-close-btn">✕ Close</button>
                    </div>
                </div>
                <div class="game-area">
                    <canvas id="tetrisCanvas" width="400" height="600"></canvas>
                    <div class="game-ui">
                        <div class="next-piece-area">
                            <h4>Next Piece:</h4>
                            <canvas id="nextPieceCanvas" width="120" height="120"></canvas>
                        </div>
                        <div class="game-instructions">
                            <p><strong>Controls:</strong></p>
                            <p>⬅️➡️ <strong>Arrow Keys:</strong> Move piece</p>
                            <p>⬇️ <strong>Down Arrow:</strong> Soft drop</p>
                            <p>⬆️ <strong>Up Arrow:</strong> Rotate piece</p>
                            <p>📱 <strong>Touch:</strong> Tap controls below</p>
                        </div>
                        <div class="touch-controls">
                            <div class="touch-row">
                                <button class="touch-btn" onmousedown="tetrisControlStart('left')" onmouseup="tetrisControlStop()" ontouchstart="tetrisControlStart('left')" ontouchend="tetrisControlStop()">⬅️</button>
                                <button class="touch-btn" onmousedown="tetrisControlStart('rotate')" onmouseup="tetrisControlStop()" ontouchstart="tetrisControlStart('rotate')" ontouchend="tetrisControlStop()">🔄</button>
                                <button class="touch-btn" onmousedown="tetrisControlStart('right')" onmouseup="tetrisControlStop()" ontouchstart="tetrisControlStart('right')" ontouchend="tetrisControlStop()">➡️</button>
                            </div>
                            <div class="touch-row">
                                <button class="touch-btn wide" onmousedown="tetrisControlStart('down')" onmouseup="tetrisControlStop()" ontouchstart="tetrisControlStart('down')" ontouchend="tetrisControlStop()">⬇️ Drop</button>
                            </div>
                        </div>
                        <div class="tetris-power-ups">
                            <h4>Special Pieces:</h4>
                            <div class="power-up-list">
                                <span class="power-up">🐸 Frog - Clears entire row!</span>
                                <span class="power-up">👮‍♂️ Fed - Removes bottom row</span>
                                <span class="power-up">💕 Heart - Bonus points</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="game-footer">
                    <button onclick="startTetris()" class="game-btn" id="startTetrisBtn">🎮 Start Game</button>
                    <button onclick="pauseTetris()" class="game-btn" id="pauseTetrisBtn" style="display:none;">⏸️ Pause</button>
                    <button onclick="resetTetris()" class="game-btn">🔄 Reset</button>
                </div>
            </div>
        </div>

        <!-- Meme Templates -->
        <section class="section" id="memes">
            <h2 class="section-title">Meme Templates</h2>
            <div class="meme-grid">
                <div class="meme-card">
                    <h4>Drake Pointing</h4>
                    <p>❌ "Violent insurrection with armed militants"</p>
                    <p>✅ "Five protesters and one of them is in a chicken suit"</p>
                </div>
                <div class="meme-card">
                    <h4>Two Buttons</h4>
                    <p>Sweating federal agent choosing between:</p>
                    <code>Button 1: "Admit there's no threat"<br>Button 2: "Pepper spray the dancing frog"</code>
                </div>
                <div class="meme-card">
                    <h4>Distracted Boyfriend</h4>
                    <p>Boyfriend = Trump administration<br>
                    Girlfriend = "Legitimate security concerns"<br>
                    Other girl = "Fighting inflatable frogs"</p>
                </div>
                <div class="meme-card">
                    <h4>This Is Fine</h4>
                    <p>Dog in burning room = "DHS calling Portland a warzone"<br>
                    Room actually fine, people playing Twister and eating pizza</p>
                </div>
                <div class="meme-card">
                    <h4>Expanding Brain</h4>
                    <code>Level 1: Riot gear for violent protests<br>
Level 2: Tactical equipment for terrorists<br>
Level 3: Full combat loadout for anarchists<br>
Level 4: National Guard for twerking unicorns</code>
                </div>
                <div class="meme-card">
                    <h4>They're The Same Picture</h4>
                    <p>Picture 1: Federal report saying "low energy, uneventful"<br>
                    Picture 2: Dancing banana suits and bubble blowing</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Interactive Frog -->
    <div class="interactive-frog" onclick="activateFrog()" title="Click me! 🐸">
        🐸
    </div>

    <!-- Easter Egg -->
    <div class="easter-egg" id="easter-egg">💕</div>

    <!-- Romance Simulator Modal -->
    <div id="romanceModal" class="modal game-modal">
        <div class="modal-content romance-modal-content">
            <span class="close" onclick="closeRomanceSimulator()">&times;</span>
            <h2>💕 Romance Simulator: Frog & Fed</h2>

            <div class="romance-game-area">
                <!-- Scene Display -->
                <div class="romance-scene">
                    <div class="scene-background" id="romanceBackground">
                        <div class="scene-characters">
                            <div class="character character-frog" id="frogCharacter">🐸</div>
                            <div class="character character-fed" id="fedCharacter">👮‍♂️</div>
                        </div>
                        <div class="scene-effects" id="sceneEffects"></div>
                    </div>
                </div>

                <!-- Story Text -->
                <div class="story-display">
                    <div class="story-text" id="storyText">
                        Welcome to the Romance Simulator! Navigate the complex relationship between our unlikely duo.
                    </div>
                    <div class="character-speaking" id="characterSpeaking"></div>
                </div>

                <!-- Choices -->
                <div class="choice-buttons" id="choiceButtons">
                    <button class="choice-btn" onclick="startRomanceGame()">🎬 Begin Story</button>
                </div>

                <!-- Stats -->
                <div class="romance-stats">
                    <div class="stat-bar">
                        <span>💕 Romance</span>
                        <div class="stat-bar-container">
                            <div class="stat-bar-fill romance-bar" id="romanceLevel" style="width: 0%"></div>
                        </div>
                        <span id="romanceValue">0%</span>
                    </div>
                    <div class="stat-bar">
                        <span>😤 Tension</span>
                        <div class="stat-bar-container">
                            <div class="stat-bar-fill tension-bar" id="tensionLevel" style="width: 50%"></div>
                        </div>
                        <span id="tensionValue">50%</span>
                    </div>
                    <div class="stat-bar">
                        <span>🤝 Understanding</span>
                        <div class="stat-bar-container">
                            <div class="stat-bar-fill understanding-bar" id="understandingLevel" style="width: 0%"></div>
                        </div>
                        <span id="understandingValue">0%</span>
                    </div>
                    <div class="romance-info">
                        <span>Chapter: <span id="currentChapter">1</span></span>
                        <span>Ending: <span id="currentEnding">Unknown</span></span>
                    </div>
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="romance-controls">
                <button onclick="resetRomanceGame()">🔄 Restart Story</button>
                <button onclick="showRomanceProgress()">📊 View Progress</button>
                <button onclick="toggleRomanceMusic()">🎵 Music</button>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal -->
    <div class="modal" id="modal">
        <div class="modal-content-enhanced">
            <span class="modal-close" onclick="closeModal()">&times;</span>

            <div class="modal-top-section">
                <div class="modal-poster-section">
                    <img id="modal-poster-img" src="" alt="">
                </div>

                <div class="modal-emoji-scene">
                    <div class="emoji-animation-container" id="emoji-scene">
                        <!-- Animated emoji scenes will be populated here -->
                    </div>
                    <div class="scene-caption" id="scene-caption">
                        <!-- Scene description -->
                    </div>
                </div>
            </div>

            <div class="modal-bottom-section">
                <div id="modal-body-enhanced">
                    <!-- Rich content goes here -->
                </div>
            </div>
        </div>
    </div>

    <footer>
        <h3>🐸 Keep Portland Weird 🦖</h3>
        <p>"When they go low, we go inflatable."</p>
        <p style="font-size: 1.2em; margin-top: 30px;">
            Operation Inflation: Making tyranny look stupid since 2025
        </p>
        <div class="credits">
            <p>Based on the true story that somehow happened in 2025</p>
            <p>Love is inflatable. Justice is non-negotiable. Spelling is optional.</p>
            <p style="margin-top: 20px;">🍌 THIS IS BANANAS 🍌</p>
        </div>
    </footer>

    <script>
        // Quotes
        const quotes = [
            {
                text: "I've definitely had spicier tamales.",
                author: "Seth Todd, after being pepper-sprayed inside his frog costume"
            },
            {
                text: "If he wants to invoke the Insurrection Act, he's going to have to point at inflatable chickens and inflatable frogs and inflatable unicorns.",
                author: "Jordy Johnson, Operation Inflation co-founder"
            },
            {
                text: "What they rely on is fear. So by coming out in an absurdist manner, it speaks to them that we're actually not that afraid.",
                author: "Jack Dickinson, elementary school teacher in chicken suit"
            },
            {
                text: "I wear this to show how ridiculous the notion that we are violent terrorists is.",
                author: "Seth Todd, proud Antifa terrorist (his words)"
            },
            {
                text: "If you're going to make it silly and say that we're evil, we're going to make it silly by showing how evil you are.",
                author: "Brooks Brown, Operation Inflation co-founder"
            },
            {
                text: "It's eight journalists, five protesters, and one of them is in a chicken suit.",
                author: "Jack Dickinson, describing the 'Antifa Army'"
            },
            {
                text: "We're in the silliest timeline, so I thought, why not be silly with it?",
                author: "Banana-suited protester"
            },
            {
                text: "THIS IS BANANAS",
                author: "Sign held by banana-suited protester (self-aware absurdism at its finest)"
            }
        ];

        let currentQuoteIndex = 0;

        function updateQuote() {
            document.getElementById('quote-text').textContent = `"${quotes[currentQuoteIndex].text}"`;
            document.getElementById('quote-author').textContent = `— ${quotes[currentQuoteIndex].author}`;
        }

        function nextQuote() {
            currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
            updateQuote();
        }

        function previousQuote() {
            currentQuoteIndex = (currentQuoteIndex - 1 + quotes.length) % quotes.length;
            updateQuote();
        }

        function randomQuote() {
            currentQuoteIndex = Math.floor(Math.random() * quotes.length);
            updateQuote();
        }

        // Interactive Frog
        let frogClicks = 0;
        function activateFrog() {
            const frog = document.querySelector('.interactive-frog');
            const easterEgg = document.getElementById('easter-egg');
            
            frog.classList.add('active');
            setTimeout(() => frog.classList.remove('active'), 500);
            
            frogClicks++;
            
            if (frogClicks === 5) {
                easterEgg.textContent = '🐸';
                easterEgg.classList.add('show');
                setTimeout(() => easterEgg.classList.remove('show'), 1000);
            } else if (frogClicks === 10) {
                easterEgg.textContent = '💕';
                easterEgg.classList.add('show');
                setTimeout(() => easterEgg.classList.remove('show'), 1000);
            } else if (frogClicks === 15) {
                easterEgg.textContent = '🚔';
                easterEgg.classList.add('show');
                setTimeout(() => easterEgg.classList.remove('show'), 1000);
            } else if (frogClicks >= 20) {
                easterEgg.textContent = '💖 LOVE IS INFLATABLE 💖';
                easterEgg.style.fontSize = '5rem';
                easterEgg.classList.add('show');
                setTimeout(() => {
                    easterEgg.classList.remove('show');
                    easterEgg.style.fontSize = '10rem';
                }, 2000);
                frogClicks = 0;
            }
        }

        // Enhanced Modal with Emoji Scenes
        function showModal(posterId) {
            const modal = document.getElementById('modal');
            const modalPosterImg = document.getElementById('modal-poster-img');
            const emojiScene = document.getElementById('emoji-scene');
            const sceneCaption = document.getElementById('scene-caption');
            const modalBody = document.getElementById('modal-body-enhanced');

            // Poster assets mapping
            const posterAssets = {
                notebook: 'assets/frog-and-fed-notebook.png',
                sally: 'assets/when-riot-met-sally.png',
                titanic: 'assets/titanic-portand.png',
                star: 'assets/star-is-inflated.png',
                fault: 'assets/fault-in-our-teargas.png',
                pride: 'assets/pride-and-pepperspray.png',
                eternal: 'assets/eternal-sunshine-protest.png',
                lady: 'assets/lady-and-tactical-response.png',
                ghost: 'assets/ghost-portland.png',
                fifty: 'assets/fifty-shades-pepperspray.png'
            };

            // Emoji scenes with animations
            const emojiScenes = {
                notebook: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">💧</div>
                        <div style="margin: 0 20px;">↔️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                    `,
                    caption: "A moment of connection in the Portland rain"
                },
                sally: {
                    html: `
                        <div class="emoji-bounce">🐸</div>
                        <div class="emoji-float">☕</div>
                        <div style="margin: 0 20px;">👁️‍🗨️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                        <div class="emoji-float">🍩</div>
                    `,
                    caption: "Can a fed and a frog be just friends?"
                },
                titanic: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">🌉</div>
                        <div class="emoji-bounce">🎇</div>
                        <br>
                        <div style="font-size: 1.5rem; margin-top: 10px;">🚢💔</div>
                    `,
                    caption: "I'm the king of the world! (Portland edition)"
                },
                star: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">🎤</div>
                        <div class="emoji-bounce">✨</div>
                        <br>
                        <div style="margin-top: 15px;">👮‍♂️📸</div>
                    `,
                    caption: "Sometimes you find your voice in the most unexpected places"
                },
                fault: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">💨</div>
                        <div style="margin: 0 20px;">❤️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                        <div class="emoji-float">😢</div>
                    `,
                    caption: "Okay? Okay. (Some infinities are inflatable)"
                },
                pride: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">🌫️</div>
                        <div style="margin: 0 20px;">↔️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                        <div class="emoji-float">🎭</div>
                    `,
                    caption: "You have bewitched me, body and googly-eyed soul"
                },
                eternal: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">✨</div>
                        <div class="emoji-bounce">🌪️</div>
                        <div class="emoji-float">👮‍♂️</div>
                        <div class="emoji-heart">🌈</div>
                    `,
                    caption: "Meet me in Portland... in the memory hole"
                },
                lady: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">🍝</div>
                        <div style="margin: 0 20px;">↔️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                        <div class="emoji-float">🎵</div>
                    `,
                    caption: "Bella notte... full of tear gas"
                },
                ghost: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">🎨</div>
                        <div class="emoji-bounce">👻</div>
                        <div class="emoji-float">👮‍♂️</div>
                        <div class="emoji-heart">🏺</div>
                    `,
                    caption: '"Ditto" - The Frog, probably'
                },
                fifty: {
                    html: `
                        <div class="emoji-float">🐸</div>
                        <div class="emoji-heart">⛓️</div>
                        <div style="margin: 0 20px;">↔️</div>
                        <div class="emoji-bounce">👮‍♂️</div>
                        <div class="emoji-float">🏢</div>
                    `,
                    caption: '"Mr. Fed will see you now"'
                }
            };

            // Rich content with production notes and quotes
            const richContent = {
                notebook: `
                    <h2>🎬 THE FROG AND THE FED</h2>
                    <h3><em>The Notebook Style</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🎭 Director's Commentary</h4>
                        <p><em>"We knew we had to nail the rain scene. After 47 takes and three different sprinkler systems, we finally captured that perfect moment of googly-eyed vulnerability."</em></p>
                        <p><strong>- Director, probably</strong></p>
                    </div>

                    <h4>💬 Memorable Quotes</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "If you love something, set it free. If it bounces back, it's probably an inflatable frog."
                    </blockquote>

                    <h4>🎬 Production Notes</h4>
                    <ul>
                        <li><strong>Weather Challenges:</strong> Real Portland rain wasn't dramatic enough, so they added three fog machines</li>
                        <li><strong>Costume Design:</strong> Federal agent's tactical gear sourced from actual protest surplus</li>
                        <li><strong>Location:</strong> Filmed on location in Tom McCall Waterfront Park (with permits, surprisingly)</li>
                        <li><strong>Special Effects:</strong> The frog's emotional range was achieved through strategic googly eye placement</li>
                    </ul>

                    <div style="background: var(--accent); color: white; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>🏆 Awards Season Buzz:</strong> "Best Use of Inflatable Props in a Dramatic Romance" - Portland Film Critics Circle (probably)
                    </div>
                `,
                sally: `
                    <h2>🎬 WHEN RIOT MET SALLY</h2>
                    <h3><em>A Rom-Com for the Ages</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🎭 Behind the Scenes</h4>
                        <p><em>"The hardest part was getting the frog to stay in character during the diner scene. We went through 12 donuts just for the background shot."</em></p>
                        <p><strong>- Craft Services Coordinator</strong></p>
                    </div>

                    <h4>💬 Classic Lines</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "I'll have what she's having."<br>
                        <small>- Woman watching frog bounce past her table</small>
                    </blockquote>

                    <h4>🍩 Portland Product Placement</h4>
                    <ul>
                        <li><strong>Voodoo Doughnut:</strong> Visible in 47% of frames (contractual obligation)</li>
                        <li><strong>Stumptown Coffee:</strong> The fed's drink of choice</li>
                        <li><strong>Powell's Books:</strong> Frog's backstory involves a radical reading list</li>
                    </ul>

                    <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>🎪 Fun Fact:</strong> The "split-screen" effect was actually achieved by putting a mirror down the middle of the table. The frog kept getting confused by its reflection.
                    </div>
                `,
                titanic: `
                    <h2>🎬 TITANIC: PORTLAND STORY</h2>
                    <h3><em>Epic Romance Meets Tactical Response</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🌉 Location, Location, Location</h4>
                        <p><em>"We considered the Burnside Bridge, but the Steel Bridge just had that 'doomed ocean liner' aesthetic we were looking for."</em></p>
                        <p><strong>- Location Manager</strong></p>
                    </div>

                    <h4>💬 Iconic Moment</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Draw me like one of your French frogs"<br>
                        <small>- Definitely not what was actually said, but what we all heard</small>
                    </blockquote>

                    <h4>🎬 Technical Innovations</h4>
                    <ul>
                        <li><strong>Sinking Effect:</strong> ICE facility model sank convincingly (3rd take)</li>
                        <li><strong>Wind Machine:</strong> Borrowed from a local car dealership's grand opening</li>
                        <li><strong>Safety Protocols:</strong> Three lifeguards on standby (none needed, thankfully)</li>
                    </ul>
                `,
                star: `
                    <h2>🎬 A STAR IS INFLATED</h2>
                    <h3><em>Musical Drama Meets Protest Movement</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🎤 Musical Direction</h4>
                        <p><em>"The frog's vocal range was surprisingly limited, but what it lacked in pitch, it made up for in authentic squeaking."</em></p>
                        <p><strong>- Sound Engineer</strong></p>
                    </div>

                    <h4>💬 Song Highlights</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        🎵 "Maybe it's time to let the old ways die... and try inflatable resistance" 🎵
                    </blockquote>

                    <h4>🎭 Supporting Cast</h4>
                    <ul>
                        <li><strong>Banana Bloc Band:</strong> Provided backup music and moral support</li>
                        <li><strong>Audience Extras:</strong> 200 actual Portland residents (paid in coffee)</li>
                        <li><strong>Stage Manager:</strong> Former circus performer (inflatable animal experience required)</li>
                    </ul>
                `,
                fault: `
                    <h2>🎬 THE FAULT IN OUR TEARGAS</h2>
                    <h3><em>Young Adult Romance Meets Constitutional Crisis</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>💨 Special Effects Challenge</h4>
                        <p><em>"Making tear gas clouds form a heart shape required wind machines, colored smoke, and three meteorology consultants."</em></p>
                        <p><strong>- VFX Supervisor</strong></p>
                    </div>

                    <h4>💬 Tender Moments</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Okay?"<br>
                        "Okay."<br>
                        <small>- The most emotionally devastating exchange in protest cinema</small>
                    </blockquote>

                    <h4>🎭 Emotional Depth</h4>
                    <ul>
                        <li><strong>Googly Eye Acting:</strong> Revolutionary technique for inflatable performers</li>
                        <li><strong>Mask Removal Scene:</strong> Fed's vulnerable moment, take 23</li>
                        <li><strong>Symbolic Imagery:</strong> Some infinities really are inflatable</li>
                    </ul>
                `,
                pride: `
                    <h2>🎬 PRIDE AND PEPPER SPRAY</h2>
                    <h3><em>Period Drama Meets Modern Protest</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🎭 Jane Austen's Vision</h4>
                        <p><em>"We asked ourselves: What would happen if Mr. Darcy was a federal agent and Elizabeth Bennet was an inflatable frog?"</em></p>
                        <p><strong>- Literary Consultant</strong></p>
                    </div>

                    <h4>💬 Regency Romance Dialogue</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "You have bewitched me, body and googly-eyed soul, and I love, I love, I love you."
                    </blockquote>

                    <h4>🏛️ Constitutional Drama</h4>
                    <ul>
                        <li><strong>Period Costumes:</strong> Tactical gear meets Empire waistlines</li>
                        <li><strong>Ballroom Scene:</strong> Portland park transformed with string quartet</li>
                        <li><strong>Class Commentary:</strong> Federal agents vs. inflatable protesters</li>
                    </ul>
                `,
                eternal: `
                    <h2>🎬 ETERNAL SUNSHINE OF THE SPOTLESS PROTEST</h2>
                    <h3><em>Surreal Memory Drama</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🌪️ Memory Landscapes</h4>
                        <p><em>"We literally erased Portland landmarks during filming. The city planning department was not amused."</em></p>
                        <p><strong>- Set Designer</strong></p>
                    </div>

                    <h4>💬 Mind-Bending Dialogue</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Meet me in Portland... in the memory hole where protests become love stories."
                    </blockquote>

                    <h4>🧠 Conceptual Challenges</h4>
                    <ul>
                        <li><strong>Floating Objects:</strong> Everything had to look weightless and dreamlike</li>
                        <li><strong>Timeline Confusion:</strong> Editor quit halfway through</li>
                        <li><strong>Reality Bending:</strong> Audiences still confused about what actually happened</li>
                    </ul>
                `,
                lady: `
                    <h2>🎬 LADY AND THE TACTICAL RESPONSE</h2>
                    <h3><em>Disney Classic Gets Political</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🍝 The Spaghetti Scene</h4>
                        <p><em>"We went through 47 pounds of spaghetti. The frog kept deflating from sauce weight."</em></p>
                        <p><strong>- Food Stylist</strong></p>
                    </div>

                    <h4>💬 Romantic Dining</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Bella notte... full of tear gas, but still somehow romantic."
                    </blockquote>

                    <h4>🎵 Musical Numbers</h4>
                    <ul>
                        <li><strong>Accordion Player:</strong> Member of Banana Bloc provided authentic atmosphere</li>
                        <li><strong>Italian Lighting:</strong> Romantic despite nearby federal vehicles</li>
                        <li><strong>Banner Kiss:</strong> Most unusual shared spaghetti substitute in cinema</li>
                    </ul>
                `,
                ghost: `
                    <h2>🎬 GHOST: THE PORTLAND CUT</h2>
                    <h3><em>Supernatural Romance Meets Crafts & Resistance</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🏺 The Pottery Scene</h4>
                        <p><em>"Instead of a pottery wheel, we used a protest sign-making station. Much more authentic to the Portland experience."</em></p>
                        <p><strong>- Props Master</strong></p>
                    </div>

                    <h4>💬 Spiritual Connection</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Ditto"<br>
                        <small>- The Frog's most profound philosophical statement</small>
                    </blockquote>

                    <h4>🎨 Artistic Elements</h4>
                    <ul>
                        <li><strong>Bob Ross Cameo:</strong> Painting visible in background (estate approved)</li>
                        <li><strong>Clay Molding:</strong> Protest signs shaped like declarations of love</li>
                        <li><strong>Unchained Melody:</strong> Played on kazoos by Banana Bloc</li>
                    </ul>
                `,
                fifty: `
                    <h2>🎬 FIFTY SHADES OF TACTICAL GREY</h2>
                    <h3><em>Power Dynamics in Federal Protest Response</em></h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4>🏢 The Red Room (Protest Zone)</h4>
                        <p><em>"We had to balance the steamy atmosphere with constitutional law. The legal consultants were... interesting."</em></p>
                        <p><strong>- Director of Photography</strong></p>
                    </div>

                    <h4>💬 Power Exchange</h4>
                    <blockquote style="border-left: 4px solid var(--primary); padding-left: 20px; margin: 20px 0; font-style: italic;">
                        "Mr. Fed will see you now... in the protest zone."
                    </blockquote>

                    <h4>⛓️ Boundary Exploration</h4>
                    <ul>
                        <li><strong>Safe Words:</strong> "Constitution" and "First Amendment"</li>
                        <li><strong>Power Dynamics:</strong> Federal authority vs. inflatable resistance</li>
                        <li><strong>Pepper Spray Prop:</strong> Suspended suggestively but never used</li>
                    </ul>

                    <div style="background: #333; color: white; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>⚠️ Disclaimer:</strong> No inflatable frogs were harmed in the making of this film. All googly eyes consented.
                    </div>
                `
            };

            // Set poster image
            modalPosterImg.src = posterAssets[posterId] || '';
            modalPosterImg.alt = `${posterId} movie poster`;

            // Set emoji scene
            const scene = emojiScenes[posterId];
            if (scene) {
                emojiScene.innerHTML = scene.html;
                sceneCaption.textContent = scene.caption;
            }

            // Set rich content
            modalBody.innerHTML = richContent[posterId] || '<p>🎬 Coming soon to a protest near you!</p>';

            // Show modal
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        // Close modal on outside click
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Random background animations
        function createFloatingEmoji() {
            const emojis = ['🐸', '🦖', '🍌', '🦄', '🐔', '💕', '✨'];
            const emoji = document.createElement('div');
            emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            emoji.style.position = 'fixed';
            emoji.style.left = Math.random() * 100 + 'vw';
            emoji.style.top = '-50px';
            emoji.style.fontSize = '2rem';
            emoji.style.opacity = '0.3';
            emoji.style.pointerEvents = 'none';
            emoji.style.zIndex = '0';
            emoji.style.animation = 'fall 10s linear';
            
            document.body.appendChild(emoji);
            
            setTimeout(() => emoji.remove(), 10000);
        }

        // Add fall animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                to {
                    top: 100vh;
                    transform: rotate(360deg);
                }
            }
        `;
        document.head.appendChild(style);

        // Create floating emojis periodically
        setInterval(createFloatingEmoji, 3000);

        // Hero Particle System
        class HeroParticleSystem {
            constructor() {
                this.canvas = document.getElementById('particleCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.mouse = { x: 0, y: 0 };
                this.isTouch = window.matchMedia('(pointer: coarse)').matches;

                this.init();
                this.bindEvents();
                this.animate();

                // Weather effects
                this.initWeatherEffects();
            }

            init() {
                this.resize();
                this.createParticles();
            }

            resize() {
                const rect = this.canvas.parentElement.getBoundingClientRect();
                this.canvas.width = rect.width;
                this.canvas.height = rect.height;
            }

            createParticles() {
                const particleCount = this.isTouch ? 8 : 15;
                const emojis = ['🐸', '💧', '👮‍♂️', '💕', '🌫️', '✨'];

                for (let i = 0; i < particleCount; i++) {
                    this.particles.push({
                        emoji: emojis[Math.floor(Math.random() * emojis.length)],
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        vx: (Math.random() - 0.5) * 0.5,
                        vy: (Math.random() - 0.5) * 0.5,
                        rotation: Math.random() * 360,
                        rotationSpeed: (Math.random() - 0.5) * 2,
                        scale: 0.8 + Math.random() * 0.4,
                        opacity: 0.3 + Math.random() * 0.4,
                        phase: Math.random() * Math.PI * 2
                    });
                }
            }

            bindEvents() {
                window.addEventListener('resize', () => this.resize());

                if (!this.isTouch) {
                    this.canvas.addEventListener('mousemove', (e) => {
                        const rect = this.canvas.getBoundingClientRect();
                        this.mouse.x = e.clientX - rect.left;
                        this.mouse.y = e.clientY - rect.top;
                    });
                }
            }

            updateParticles() {
                this.particles.forEach(particle => {
                    // Floating motion
                    particle.x += particle.vx + Math.sin(Date.now() * 0.001 + particle.phase) * 0.1;
                    particle.y += particle.vy + Math.cos(Date.now() * 0.0008 + particle.phase) * 0.1;
                    particle.rotation += particle.rotationSpeed;

                    // Mouse interaction (desktop only)
                    if (!this.isTouch) {
                        const dx = this.mouse.x - particle.x;
                        const dy = this.mouse.y - particle.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 100) {
                            const force = (100 - distance) / 100;
                            particle.x -= dx * force * 0.01;
                            particle.y -= dy * force * 0.01;
                        }
                    }

                    // Boundary wrapping
                    if (particle.x < -50) particle.x = this.canvas.width + 50;
                    if (particle.x > this.canvas.width + 50) particle.x = -50;
                    if (particle.y < -50) particle.y = this.canvas.height + 50;
                    if (particle.y > this.canvas.height + 50) particle.y = -50;
                });
            }

            drawParticles() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                this.particles.forEach(particle => {
                    this.ctx.save();
                    this.ctx.globalAlpha = particle.opacity;
                    this.ctx.translate(particle.x, particle.y);
                    this.ctx.rotate(particle.rotation * Math.PI / 180);
                    this.ctx.scale(particle.scale, particle.scale);
                    this.ctx.font = '24px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.fillText(particle.emoji, 0, 0);
                    this.ctx.restore();
                });
            }

            animate() {
                this.updateParticles();
                this.drawParticles();
                requestAnimationFrame(() => this.animate());
            }

            initWeatherEffects() {
                const weatherContainer = document.getElementById('weatherEffects');

                // Create rain drops periodically
                setInterval(() => {
                    if (Math.random() < 0.3) { // 30% chance
                        this.createWeatherParticle(weatherContainer, '💧');
                    }
                    if (Math.random() < 0.1) { // 10% chance
                        this.createWeatherParticle(weatherContainer, '🌫️');
                    }
                }, 800);
            }

            createWeatherParticle(container, emoji) {
                const particle = document.createElement('div');
                particle.className = 'weather-particle';
                particle.textContent = emoji;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (4 + Math.random() * 4) + 's';
                particle.style.animationDelay = Math.random() * 2 + 's';

                container.appendChild(particle);

                // Remove after animation
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 8000);
            }
        }

        // Animated Statistics System
        class StatsAnimator {
            constructor() {
                this.observer = null;
                this.init();
            }

            init() {
                // Set up intersection observer to trigger animations when stats come into view
                this.observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            this.animateStatsSection(entry.target);
                        }
                    });
                }, {
                    threshold: 0.3
                });

                // Observe the stats section
                const statsSection = document.getElementById('stats');
                if (statsSection) {
                    this.observer.observe(statsSection);
                }
            }

            animateStatsSection(section) {
                const statCards = section.querySelectorAll('.stat-card');

                statCards.forEach((card, index) => {
                    // Delay each card animation slightly for a staggered effect
                    setTimeout(() => {
                        this.animateStatCard(card);
                    }, index * 200);
                });

                // Disconnect observer after first trigger
                this.observer.disconnect();
            }

            animateStatCard(card) {
                const numberElement = card.querySelector('.stat-number');
                const celebrationElement = card.querySelector('.stat-emoji-celebration');
                const target = card.dataset.target;
                const suffix = card.dataset.suffix || '';

                // Skip animation for infinity symbol
                if (target === '∞') {
                    this.triggerCelebration(celebrationElement);
                    return;
                }

                const targetNum = parseInt(target);
                let current = 0;
                const duration = 1500; // 1.5 seconds
                const startTime = Date.now();

                // Add counting class
                card.classList.add('counting');
                numberElement.classList.add('counting');

                const updateNumber = () => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);

                    // Use easeOutCubic for smooth deceleration
                    const easeProgress = 1 - Math.pow(1 - progress, 3);
                    current = Math.floor(targetNum * easeProgress);

                    // Format the number display
                    let displayValue = this.formatNumber(current);
                    if (suffix && progress === 1) {
                        displayValue += suffix;
                    }

                    numberElement.textContent = displayValue;

                    if (progress < 1) {
                        requestAnimationFrame(updateNumber);
                    } else {
                        // Animation complete
                        card.classList.remove('counting');
                        numberElement.classList.remove('counting');
                        numberElement.classList.add('completed');

                        // Trigger celebration emoji
                        this.triggerCelebration(celebrationElement);

                        // Remove completed class after animation
                        setTimeout(() => {
                            numberElement.classList.remove('completed');
                        }, 800);
                    }
                };

                updateNumber();
            }

            formatNumber(num) {
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(0) + 'k';
                } else {
                    return num.toString();
                }
            }

            triggerCelebration(element) {
                if (!element) return;

                element.classList.add('active');

                // Remove class after animation completes
                setTimeout(() => {
                    element.classList.remove('active');
                }, 1500);
            }
        }

        // Interactive Timeline System
        class InteractiveTimeline {
            constructor() {
                this.currentMode = 'story';
                this.storyData = this.initializeStoryData();
                this.characterData = this.initializeCharacterData();
                this.init();
            }

            init() {
                this.bindModeButtons();
                this.setupAnalytics();
            }

            bindModeButtons() {
                const modeButtons = document.querySelectorAll('.timeline-mode-btn');
                modeButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const mode = e.target.dataset.mode;
                        this.switchMode(mode);
                        this.trackInteraction('mode_change', mode);
                    });
                });
            }

            switchMode(mode) {
                this.currentMode = mode;

                // Update button states
                document.querySelectorAll('.timeline-mode-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.mode === mode);
                });

                // Update timeline content based on mode
                this.updateTimelineContent(mode);
            }

            updateTimelineContent(mode) {
                const timelineItems = document.querySelectorAll('.timeline-item');

                timelineItems.forEach(item => {
                    const content = item.querySelector('.timeline-content');
                    const storyId = item.dataset.storyId;

                    if (storyId && this.storyData[storyId]) {
                        const data = this.storyData[storyId];
                        const modeContent = data.modes[mode] || data.modes.story;

                        // Update the content while preserving structure
                        const title = content.querySelector('h4');
                        const description = content.querySelector('p');

                        if (title) title.textContent = modeContent.title;
                        if (description) description.textContent = modeContent.description;
                    }
                });
            }

            initializeStoryData() {
                return {
                    beginning: {
                        modes: {
                            story: {
                                title: "June 2025: The Meet-Cute",
                                description: "Seth Todd, a 24-year-old with a heart full of hope and a costume full of air, first dons the frog suit. Little does he know, his future love interest is getting fitted for tactical gear across town."
                            },
                            documentary: {
                                title: "June 2025: The Beginning",
                                description: "Seth Todd, 24, starts wearing a green inflatable frog costume to ICE facility protests. His mission: show how ridiculous the 'violent terrorist' narrative is."
                            },
                            characters: {
                                title: "Seth's Origin Story",
                                description: "Meet Seth Todd: College graduate, amateur comedian, professional absurdist. His superpower? Making authoritarianism look ridiculous one costume at a time."
                            }
                        }
                    }
                };
            }

            initializeCharacterData() {
                return {
                    seth: {
                        name: "Seth Todd",
                        age: 24,
                        role: "The Romantic Lead (Frog)",
                        backstory: "A recent college graduate with a degree in political science and a minor in performance art. Seth discovered his calling when he realized that the best way to combat fear-mongering was with googly eyes and an air pump.",
                        personality: "Witty, fearless, surprisingly philosophical about civil disobedience",
                        famousQuote: "I've definitely had spicier tamales.",
                        loveLanguage: "Acts of resistance",
                        emoji: "🐸"
                    },
                    fed: {
                        name: "Agent [REDACTED]",
                        age: "Classified",
                        role: "The Brooding Love Interest",
                        backstory: "A federal agent caught between duty and the growing realization that maybe, just maybe, the dancing frog has a point.",
                        personality: "Stoic exterior, conflicted interior, secretly loves the absurdity",
                        famousQuote: "[Classified, but probably involves tactical gear and feelings]",
                        loveLanguage: "Begrudging respect",
                        emoji: "👮‍♂️"
                    }
                };
            }

            setupAnalytics() {
                this.analytics = {
                    interactions: [],
                    timeSpent: {},
                    modesExplored: new Set(),
                    storiesViewed: new Set(),
                    sessionStart: Date.now(),
                    totalVisits: parseInt(localStorage.getItem('totalVisits') || '0') + 1,
                    returningUser: localStorage.getItem('timelineAnalytics') !== null
                };

                // Track page sections visited
                this.setupSectionTracking();

                // Track time spent on site
                this.setupTimeTracking();

                // Save visit count
                localStorage.setItem('totalVisits', this.analytics.totalVisits.toString());
            }

            setupSectionTracking() {
                const sections = ['hero', 'posters', 'quotes', 'story', 'meme-generator', 'memes', 'stats'];
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            this.trackInteraction('section_viewed', {
                                section: entry.target.id,
                                timestamp: Date.now()
                            });
                        }
                    });
                }, { threshold: 0.3 });

                sections.forEach(sectionId => {
                    const element = document.getElementById(sectionId);
                    if (element) observer.observe(element);
                });
            }

            setupTimeTracking() {
                // Track time spent in different sections
                let currentSection = null;
                let sectionStartTime = Date.now();

                const updateTimeSpent = (section) => {
                    if (currentSection) {
                        this.analytics.timeSpent[currentSection] =
                            (this.analytics.timeSpent[currentSection] || 0) +
                            (Date.now() - sectionStartTime);
                    }
                    currentSection = section;
                    sectionStartTime = Date.now();
                };

                // Track scroll position to determine current section
                window.addEventListener('scroll', () => {
                    const sections = ['hero', 'posters', 'quotes', 'story', 'meme-generator', 'memes', 'stats'];
                    const scrollPosition = window.scrollY + window.innerHeight / 2;

                    for (const sectionId of sections) {
                        const element = document.getElementById(sectionId);
                        if (element) {
                            const rect = element.getBoundingClientRect();
                            const absoluteTop = window.scrollY + rect.top;
                            const absoluteBottom = absoluteTop + rect.height;

                            if (scrollPosition >= absoluteTop && scrollPosition <= absoluteBottom) {
                                if (currentSection !== sectionId) {
                                    updateTimeSpent(sectionId);
                                }
                                break;
                            }
                        }
                    }
                });

                // Save time data on page unload
                window.addEventListener('beforeunload', () => {
                    updateTimeSpent(null);
                    this.saveAnalyticsData();
                });

                // Periodic save
                setInterval(() => {
                    this.saveAnalyticsData();
                }, 30000); // Save every 30 seconds
            }

            trackInteraction(type, data) {
                this.analytics.interactions.push({
                    type,
                    data,
                    timestamp: Date.now(),
                    sessionId: this.getSessionId()
                });

                if (type === 'mode_change') {
                    this.analytics.modesExplored.add(data);
                }

                if (type === 'story_opened') {
                    this.analytics.storiesViewed.add(data.storyId);
                }

                // Store in localStorage for persistence
                this.saveAnalyticsData();

                // Send to engagement dashboard if enabled
                this.updateEngagementDashboard();
            }

            getSessionId() {
                if (!this.sessionId) {
                    this.sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                }
                return this.sessionId;
            }

            saveAnalyticsData() {
                const analyticsData = {
                    ...this.analytics,
                    modesExplored: Array.from(this.analytics.modesExplored),
                    storiesViewed: Array.from(this.analytics.storiesViewed),
                    lastUpdated: Date.now()
                };
                localStorage.setItem('timelineAnalytics', JSON.stringify(analyticsData));
            }

            updateEngagementDashboard() {
                // Update real-time engagement metrics
                if (document.getElementById('engagement-dashboard')) {
                    this.refreshDashboard();
                }
            }

            showEngagementDashboard() {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'block';
                modal.innerHTML = `
                    <div class="modal-content engagement-modal">
                        <span class="close" onclick="this.closest('.modal').remove()">&times;</span>
                        <h2>📊 Your Engagement Stats</h2>
                        <div id="engagement-dashboard">
                            ${this.generateDashboardHTML()}
                        </div>
                        <div class="engagement-actions">
                            <button onclick="window.timelineSystem.exportAnalytics()" class="engagement-btn">
                                📁 Export Data
                            </button>
                            <button onclick="window.timelineSystem.resetAnalytics()" class="engagement-btn reset">
                                🗑️ Reset Stats
                            </button>
                        </div>
                    </div>
                `;

                // Add click-outside-to-close functionality
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);
            }

            generateDashboardHTML() {
                const totalTimeSpent = Object.values(this.analytics.timeSpent).reduce((a, b) => a + b, 0);
                const totalInteractions = this.analytics.interactions.length;
                const sessionsToday = this.analytics.totalVisits;

                return `
                    <div class="engagement-grid">
                        <div class="engagement-card">
                            <div class="engagement-number">${Math.round(totalTimeSpent / 1000 / 60)}m</div>
                            <div class="engagement-label">Time Spent</div>
                        </div>
                        <div class="engagement-card">
                            <div class="engagement-number">${totalInteractions}</div>
                            <div class="engagement-label">Interactions</div>
                        </div>
                        <div class="engagement-card">
                            <div class="engagement-number">${sessionsToday}</div>
                            <div class="engagement-label">Total Visits</div>
                        </div>
                        <div class="engagement-card">
                            <div class="engagement-number">${this.analytics.modesExplored.size}/3</div>
                            <div class="engagement-label">Modes Explored</div>
                        </div>
                        <div class="engagement-card">
                            <div class="engagement-number">${this.analytics.storiesViewed.size}</div>
                            <div class="engagement-label">Stories Viewed</div>
                        </div>
                        <div class="engagement-card">
                            <div class="engagement-number">${this.analytics.returningUser ? 'Yes' : 'No'}</div>
                            <div class="engagement-label">Returning User</div>
                        </div>
                    </div>
                    <div class="engagement-breakdown">
                        <h3>🎯 Time by Section</h3>
                        ${this.generateTimeBreakdown()}
                    </div>
                    <div class="engagement-activity">
                        <h3>🔥 Recent Activity</h3>
                        ${this.generateActivityFeed()}
                    </div>
                `;
            }

            generateTimeBreakdown() {
                const sectionNames = {
                    hero: 'Hero Section',
                    posters: 'Movie Posters',
                    quotes: 'Quotes',
                    story: 'Interactive Timeline',
                    'meme-generator': 'Meme Generator',
                    memes: 'Meme Templates',
                    stats: 'Statistics'
                };

                const totalTime = Object.values(this.analytics.timeSpent).reduce((a, b) => a + b, 0);

                return Object.entries(this.analytics.timeSpent)
                    .sort(([,a], [,b]) => b - a)
                    .map(([section, time]) => {
                        const percentage = totalTime > 0 ? Math.round((time / totalTime) * 100) : 0;
                        const minutes = Math.round(time / 1000 / 60);
                        return `
                            <div class="time-breakdown-item">
                                <div class="section-name">${sectionNames[section] || section}</div>
                                <div class="time-bar">
                                    <div class="time-fill" style="width: ${percentage}%"></div>
                                </div>
                                <div class="time-value">${minutes}m (${percentage}%)</div>
                            </div>
                        `;
                    }).join('');
            }

            generateActivityFeed() {
                const recentActivities = this.analytics.interactions
                    .slice(-10)
                    .reverse()
                    .map(activity => {
                        const time = new Date(activity.timestamp).toLocaleTimeString();
                        const actionEmojis = {
                            mode_change: '🔄',
                            story_opened: '📖',
                            character_explored: '👤',
                            meme_generated: '🎨',
                            meme_downloaded: '💾',
                            easter_egg_discovered: '🥚',
                            section_viewed: '👁️'
                        };

                        const emoji = actionEmojis[activity.type] || '🔹';
                        const description = this.getActivityDescription(activity);

                        return `
                            <div class="activity-item">
                                <span class="activity-emoji">${emoji}</span>
                                <span class="activity-description">${description}</span>
                                <span class="activity-time">${time}</span>
                            </div>
                        `;
                    }).join('');

                return recentActivities || '<div class="no-activity">No recent activity</div>';
            }

            getActivityDescription(activity) {
                switch (activity.type) {
                    case 'mode_change':
                        return `Switched to ${activity.data} mode`;
                    case 'story_opened':
                        return `Opened ${activity.data.storyId} story`;
                    case 'character_explored':
                        return `Explored ${activity.data} character`;
                    case 'meme_generated':
                        return `Generated ${activity.data.template} meme`;
                    case 'meme_downloaded':
                        return `Downloaded meme`;
                    case 'easter_egg_discovered':
                        return `Found "${activity.data.name}" easter egg`;
                    case 'section_viewed':
                        return `Viewed ${activity.data.section} section`;
                    default:
                        return `${activity.type} interaction`;
                }
            }

            exportAnalytics() {
                const data = {
                    ...this.analytics,
                    modesExplored: Array.from(this.analytics.modesExplored),
                    storiesViewed: Array.from(this.analytics.storiesViewed),
                    exportedAt: new Date().toISOString()
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `frog-fed-analytics-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);

                this.trackInteraction('analytics_exported', { timestamp: Date.now() });
            }

            resetAnalytics() {
                if (confirm('Are you sure you want to reset all analytics data? This cannot be undone.')) {
                    localStorage.removeItem('timelineAnalytics');
                    localStorage.removeItem('totalVisits');
                    localStorage.removeItem('easterEggDiscoveries');
                    location.reload();
                }
            }
        }

        // Global function for timeline story clicks
        function openTimelineStory(element) {
            const storyId = element.dataset.storyId;
            const character = element.dataset.character;

            // Track the interaction
            if (window.timelineSystem) {
                window.timelineSystem.trackInteraction('story_opened', { storyId, character });
            }

            // Create and show story modal
            showStoryModal(storyId, character);
        }

        function showStoryModal(storyId, character) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('story-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'story-modal';
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content story-modal-content">
                        <span class="close" onclick="closeStoryModal()">&times;</span>
                        <div class="story-content">
                            <div class="story-header">
                                <div class="story-emoji"></div>
                                <h3 class="story-title"></h3>
                            </div>
                            <div class="story-body">
                                <div class="story-narrative"></div>
                                <div class="story-choices">
                                    <button class="story-choice-btn" onclick="exploreCharacter('${character}')">
                                        👥 Learn about ${character === 'seth' ? 'Seth' : 'the Fed'}
                                    </button>
                                    <button class="story-choice-btn" onclick="showBehindScenes('${storyId}')">
                                        🎬 Behind the Scenes
                                    </button>
                                    <button class="story-choice-btn" onclick="viewAlternateEnding('${storyId}')">
                                        🎭 What If...?
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Add click-outside-to-close functionality
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeStoryModal();
                    }
                });

                // Add escape key to close
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && modal.style.display === 'block') {
                        closeStoryModal();
                    }
                });

                document.body.appendChild(modal);
            }

            // Populate modal content
            const timeline = window.timelineSystem;
            const storyData = timeline.storyData[storyId];
            const characterData = timeline.characterData[character];

            if (storyData && characterData) {
                modal.querySelector('.story-emoji').textContent = characterData.emoji;
                modal.querySelector('.story-title').textContent = `${characterData.name}'s Story`;
                modal.querySelector('.story-narrative').innerHTML = `
                    <p><strong>The Romantic Comedy Version:</strong></p>
                    <p>${storyData.modes.story.description}</p>
                    <p><strong>What Really Happened:</strong></p>
                    <p>${storyData.modes.documentary.description}</p>
                `;
            }

            modal.style.display = 'block';
        }

        function closeStoryModal() {
            const modal = document.getElementById('story-modal');
            if (modal) modal.style.display = 'none';
        }

        function exploreCharacter(character) {
            const timeline = window.timelineSystem;
            const characterData = timeline.characterData[character];

            if (!characterData) return;

            // Create character exploration modal
            let modal = document.getElementById('character-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'character-modal';
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content character-modal-content">
                        <span class="close" onclick="closeCharacterModal()">&times;</span>
                        <div class="character-profile">
                            <div class="character-avatar">
                                <div class="character-emoji"></div>
                                <div class="character-name"></div>
                                <div class="character-role"></div>
                            </div>
                            <div class="character-details">
                                <div class="character-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Age:</span>
                                        <span class="stat-value character-age"></span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Love Language:</span>
                                        <span class="stat-value character-love-language"></span>
                                    </div>
                                </div>
                                <div class="character-backstory">
                                    <h4>Backstory</h4>
                                    <p class="backstory-text"></p>
                                </div>
                                <div class="character-personality">
                                    <h4>Personality</h4>
                                    <p class="personality-text"></p>
                                </div>
                                <div class="character-quote">
                                    <h4>Famous Quote</h4>
                                    <blockquote class="quote-text"></blockquote>
                                </div>
                                <div class="character-actions">
                                    <button class="character-action-btn" onclick="viewCharacterMoments('${character}')">
                                        📸 Key Moments
                                    </button>
                                    <button class="character-action-btn" onclick="createCharacterMeme('${character}')">
                                        🎨 Create Meme
                                    </button>
                                    <button class="character-action-btn" onclick="exploreRelationship('${character}')">
                                        💕 Relationship Analysis
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            // Populate character data
            modal.querySelector('.character-emoji').textContent = characterData.emoji;
            modal.querySelector('.character-name').textContent = characterData.name;
            modal.querySelector('.character-role').textContent = characterData.role;
            modal.querySelector('.character-age').textContent = characterData.age;
            modal.querySelector('.character-love-language').textContent = characterData.loveLanguage;
            modal.querySelector('.backstory-text').textContent = characterData.backstory;
            modal.querySelector('.personality-text').textContent = characterData.personality;
            modal.querySelector('.quote-text').textContent = `"${characterData.famousQuote}"`;

            modal.style.display = 'block';

            // Track character exploration
            timeline.trackInteraction('character_explored', character);
        }

        function closeCharacterModal() {
            const modal = document.getElementById('character-modal');
            if (modal) modal.style.display = 'none';
        }

        function viewCharacterMoments(character) {
            alert(`📸 Key moments for ${character} - interactive timeline coming soon!`);
        }

        function createCharacterMeme(character) {
            // Scroll to meme generator
            document.getElementById('meme-generator').scrollIntoView({ behavior: 'smooth' });

            // Pre-populate with character-specific content
            setTimeout(() => {
                const characterTexts = {
                    seth: [
                        "When you're just a frog but become a movement",
                        "I've definitely had spicier tamales",
                        "Dancing through the teargas like 🐸"
                    ],
                    fed: [
                        "When your target is too cute to arrest",
                        "Federal agent.exe has stopped working",
                        "This wasn't in the training manual"
                    ]
                };

                const texts = characterTexts[character] || characterTexts.seth;
                const randomText = texts[Math.floor(Math.random() * texts.length)];

                document.getElementById('topText').value = randomText;
                document.getElementById('templateSelect').value = 'poster';

                if (window.memeGenerator) {
                    window.memeGenerator.currentTemplate = 'poster';
                    window.memeGenerator.generateMeme();
                }

                // Track character meme creation
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('character_meme_created', character);
                }
            }, 1000);
        }

        function exploreRelationship(character) {
            const relationships = {
                seth: "The eternal optimist meets immovable object. Seth's infectious joy slowly chips away at federal stoicism, proving that laughter truly is the best form of resistance.",
                fed: "Duty vs. Heart: A classic internal conflict. Watching a dancing frog somehow makes more sense than most of their training scenarios."
            };

            alert(`💕 ${relationships[character] || 'Relationship dynamics coming soon!'}`);
        }

        function showBehindScenes(storyId) {
            alert(`Behind the scenes for ${storyId} - coming soon! 🎬`);
        }

        function viewAlternateEnding(storyId) {
            alert(`Alternate ending for ${storyId} - what if they had met differently? 🎭`);
        }

        // Meme Generator System
        class MemeGenerator {
            constructor() {
                this.canvas = document.getElementById('memeCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.currentTemplate = 'drake';
                this.templates = this.initializeTemplates();
                this.createdMemes = [];
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadFeaturedMemes();
                this.generateMeme(); // Load default template
            }

            setupEventListeners() {
                document.getElementById('templateSelect').addEventListener('change', (e) => {
                    this.currentTemplate = e.target.value;
                    this.generateMeme();
                });

                document.getElementById('topText').addEventListener('input', () => {
                    this.generateMeme();
                });

                document.getElementById('bottomText').addEventListener('input', () => {
                    this.generateMeme();
                });

                // Real-time preview
                this.setupRealTimePreview();
            }

            setupRealTimePreview() {
                let timeout;
                const inputs = ['topText', 'bottomText'];

                inputs.forEach(inputId => {
                    document.getElementById(inputId).addEventListener('input', () => {
                        clearTimeout(timeout);
                        timeout = setTimeout(() => {
                            this.generateMeme();
                        }, 300);
                    });
                });
            }

            initializeTemplates() {
                return {
                    drake: {
                        name: "Drake Pointing",
                        width: 800,
                        height: 600,
                        elements: [
                            { type: 'emoji', emoji: '🙅‍♂️', x: 100, y: 150, size: 80 },
                            { type: 'emoji', emoji: '👉', x: 100, y: 400, size: 80 },
                            { type: 'text', text: 'topText', x: 250, y: 180, maxWidth: 400, isTop: true },
                            { type: 'text', text: 'bottomText', x: 250, y: 430, maxWidth: 400, isTop: false }
                        ]
                    },
                    distracted: {
                        name: "Distracted Boyfriend",
                        width: 800,
                        height: 600,
                        elements: [
                            { type: 'emoji', emoji: '👫', x: 100, y: 300, size: 60 },
                            { type: 'emoji', emoji: '👀', x: 400, y: 250, size: 50 },
                            { type: 'emoji', emoji: '👩', x: 600, y: 280, size: 60 },
                            { type: 'text', text: 'topText', x: 400, y: 100, maxWidth: 400, isTop: true },
                            { type: 'text', text: 'bottomText', x: 400, y: 500, maxWidth: 400, isTop: false }
                        ]
                    },
                    buttons: {
                        name: "Two Buttons",
                        width: 800,
                        height: 600,
                        elements: [
                            { type: 'emoji', emoji: '😰', x: 400, y: 200, size: 80 },
                            { type: 'rect', x: 200, y: 350, width: 180, height: 60, color: '#ff6b6b' },
                            { type: 'rect', x: 420, y: 350, width: 180, height: 60, color: '#4ecdc4' },
                            { type: 'text', text: 'topText', x: 290, y: 385, maxWidth: 160, isButton: true },
                            { type: 'text', text: 'bottomText', x: 510, y: 385, maxWidth: 160, isButton: true }
                        ]
                    },
                    fine: {
                        name: "This Is Fine",
                        width: 800,
                        height: 600,
                        elements: [
                            { type: 'emoji', emoji: '🐶', x: 300, y: 300, size: 100 },
                            { type: 'emoji', emoji: '🔥', x: 150, y: 200, size: 40 },
                            { type: 'emoji', emoji: '🔥', x: 500, y: 180, size: 40 },
                            { type: 'emoji', emoji: '🔥', x: 600, y: 250, size: 40 },
                            { type: 'text', text: 'topText', x: 400, y: 100, maxWidth: 600, isTop: true },
                            { type: 'text', text: 'bottomText', x: 400, y: 500, maxWidth: 600, isTop: false }
                        ]
                    },
                    poster: {
                        name: "Movie Poster Style",
                        width: 600,
                        height: 800,
                        elements: [
                            { type: 'emoji', emoji: '🐸', x: 200, y: 300, size: 120 },
                            { type: 'emoji', emoji: '👮‍♂️', x: 400, y: 300, size: 120 },
                            { type: 'emoji', emoji: '💕', x: 300, y: 450, size: 60 },
                            { type: 'text', text: 'topText', x: 300, y: 150, maxWidth: 500, isTitle: true },
                            { type: 'text', text: 'bottomText', x: 300, y: 700, maxWidth: 500, isTagline: true }
                        ]
                    }
                };
            }

            generateMeme() {
                const template = this.templates[this.currentTemplate];
                const topText = document.getElementById('topText').value || 'TOP TEXT';
                const bottomText = document.getElementById('bottomText').value || 'BOTTOM TEXT';

                // Set canvas size
                this.canvas.width = template.width;
                this.canvas.height = template.height;

                // Clear canvas
                this.ctx.fillStyle = '#ffffff';
                this.ctx.fillRect(0, 0, template.width, template.height);

                // Draw elements
                template.elements.forEach(element => {
                    this.drawElement(element, topText, bottomText);
                });

                // Track meme generation
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('meme_generated', {
                        template: this.currentTemplate,
                        hasTopText: topText.length > 0,
                        hasBottomText: bottomText.length > 0
                    });
                }
            }

            drawElement(element, topText, bottomText) {
                const ctx = this.ctx;

                switch (element.type) {
                    case 'emoji':
                        ctx.font = `${element.size}px Arial`;
                        ctx.textAlign = 'center';
                        ctx.fillText(element.emoji, element.x, element.y);
                        break;

                    case 'rect':
                        ctx.fillStyle = element.color;
                        ctx.fillRect(element.x, element.y, element.width, element.height);
                        break;

                    case 'text':
                        const text = element.text === 'topText' ? topText : bottomText;
                        this.drawMemeText(text, element);
                        break;
                }
            }

            drawMemeText(text, element) {
                const ctx = this.ctx;

                // Set font based on text type
                if (element.isTitle) {
                    ctx.font = 'bold 48px Impact, Arial';
                } else if (element.isTagline) {
                    ctx.font = 'italic 24px Arial';
                } else if (element.isButton) {
                    ctx.font = 'bold 16px Arial';
                } else {
                    ctx.font = 'bold 32px Impact, Arial';
                }

                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // Text styling for visibility
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = element.isButton ? 1 : 3;
                ctx.fillStyle = element.isButton ? '#ffffff' : '#ffffff';

                // Word wrap for long text
                const words = text.split(' ');
                const maxWidth = element.maxWidth || 400;
                let line = '';
                let y = element.y;
                const lineHeight = element.isTitle ? 60 : (element.isButton ? 20 : 40);

                words.forEach((word, index) => {
                    const testLine = line + word + ' ';
                    const metrics = ctx.measureText(testLine);
                    const testWidth = metrics.width;

                    if (testWidth > maxWidth && index > 0) {
                        ctx.strokeText(line, element.x, y);
                        ctx.fillText(line, element.x, y);
                        line = word + ' ';
                        y += lineHeight;
                    } else {
                        line = testLine;
                    }
                });

                ctx.strokeText(line, element.x, y);
                ctx.fillText(line, element.x, y);
            }

            downloadMeme() {
                const link = document.createElement('a');
                link.download = `frog-fed-meme-${Date.now()}.png`;
                link.href = this.canvas.toDataURL();
                link.click();

                // Track download
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('meme_downloaded', {
                        template: this.currentTemplate
                    });
                }
            }

            shareToSocial() {
                if (navigator.share) {
                    this.canvas.toBlob((blob) => {
                        const file = new File([blob], 'frog-fed-meme.png', { type: 'image/png' });
                        navigator.share({
                            title: 'Check out my Frog & Fed meme!',
                            text: 'Created with the Frog & Fed meme generator 🐸👮‍♂️💕',
                            files: [file]
                        });
                    });
                } else {
                    // Fallback - copy to clipboard
                    this.canvas.toBlob((blob) => {
                        navigator.clipboard.write([
                            new ClipboardItem({ 'image/png': blob })
                        ]).then(() => {
                            alert('Meme copied to clipboard! 📋 Share it anywhere! 🐸💕');
                        }).catch(() => {
                            alert('Right-click the meme and select "Save image" to share! 📱');
                        });
                    });
                }

                // Track share
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('meme_shared', {
                        template: this.currentTemplate
                    });
                }
            }

            randomizeMeme() {
                const templates = Object.keys(this.templates);
                const randomTemplate = templates[Math.floor(Math.random() * templates.length)];

                const funnyTexts = [
                    "When they said 'violent extremists' but it's just dancing frogs",
                    "POV: You're a federal agent vs inflatable animals",
                    "This could be us but you're in tactical gear",
                    "Local frog too powerful for federal agents",
                    "Breaking: Dancing frog causes existential crisis",
                    "When your enemy is too cute to arrest",
                    "Federal agent.exe has stopped working",
                    "This is why we can't have nice protests"
                ];

                const randomTopText = funnyTexts[Math.floor(Math.random() * funnyTexts.length)];
                const randomBottomText = funnyTexts[Math.floor(Math.random() * funnyTexts.length)];

                document.getElementById('templateSelect').value = randomTemplate;
                document.getElementById('topText').value = randomTopText;
                document.getElementById('bottomText').value = randomBottomText;

                this.currentTemplate = randomTemplate;
                this.generateMeme();

                // Track randomization
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('meme_randomized', {
                        template: randomTemplate
                    });
                }
            }

            loadFeaturedMemes() {
                const featuredMemes = [
                    {
                        title: "Community Favorite",
                        description: "🐸 vs 👮‍♂️ Epic Romance",
                        likes: 420
                    },
                    {
                        title: "Viral Hit",
                        description: "Spicier than tamales 🌶️",
                        likes: 1337
                    },
                    {
                        title: "Staff Pick",
                        description: "Constitutional cuteness 💕",
                        likes: 666
                    }
                ];

                const container = document.getElementById('featuredMemes');
                container.innerHTML = featuredMemes.map(meme => `
                    <div class="featured-meme">
                        <div class="meme-title">${meme.title}</div>
                        <div class="meme-description">${meme.description}</div>
                        <div class="meme-stats">❤️ ${meme.likes} likes</div>
                    </div>
                `).join('');
            }
        }

        // Global functions for meme generator
        function addEmoji(emoji) {
            const activeInput = document.activeElement;
            if (activeInput && (activeInput.id === 'topText' || activeInput.id === 'bottomText')) {
                const start = activeInput.selectionStart;
                const end = activeInput.selectionEnd;
                const currentValue = activeInput.value;
                activeInput.value = currentValue.slice(0, start) + emoji + currentValue.slice(end);
                activeInput.setSelectionRange(start + emoji.length, start + emoji.length);
                activeInput.focus();

                // Trigger meme generation
                if (window.memeGenerator) {
                    window.memeGenerator.generateMeme();
                }
            } else {
                // Add to top text if no input is focused
                const topText = document.getElementById('topText');
                topText.value += emoji;
                topText.focus();
                if (window.memeGenerator) {
                    window.memeGenerator.generateMeme();
                }
            }
        }

        function generateMeme() {
            if (window.memeGenerator) {
                window.memeGenerator.generateMeme();
            }
        }

        function downloadMeme() {
            if (window.memeGenerator) {
                window.memeGenerator.downloadMeme();
            }
        }

        function shareToSocial() {
            if (window.memeGenerator) {
                window.memeGenerator.shareToSocial();
            }
        }

        function randomizeMeme() {
            if (window.memeGenerator) {
                window.memeGenerator.randomizeMeme();
            }
        }

        // Easter Egg System
        class EasterEggSystem {
            constructor() {
                this.discoveries = JSON.parse(localStorage.getItem('easterEggDiscoveries') || '[]');
                this.sequences = this.initializeSequences();
                this.clickCounts = {};
                this.secretMode = false;
                this.init();
            }

            init() {
                this.setupClickTracking();
                this.setupKeySequences();
                this.createDiscoveryTracker();
                this.checkForSecretUnlocks();
            }

            initializeSequences() {
                return {
                    konami: {
                        sequence: ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'],
                        name: 'Konami Code',
                        reward: 'secretMode',
                        description: 'Unlock secret frog transformation mode!'
                    },
                    frogLove: {
                        sequence: ['🐸', '💕', '👮‍♂️', '💕', '🐸'],
                        name: 'Love Sequence',
                        reward: 'romanticMode',
                        description: 'Activate romantic particle effects!'
                    },
                    spicy: {
                        sequence: ['KeyS', 'KeyP', 'KeyI', 'KeyC', 'KeyY'],
                        name: 'Spicy Code',
                        reward: 'spicyMode',
                        description: 'Everything becomes pepper spray themed!'
                    }
                };
            }

            setupClickTracking() {
                // Track clicks on specific elements
                document.addEventListener('click', (e) => {
                    const element = e.target;

                    // Frog emoji clicks
                    if (element.textContent && element.textContent.includes('🐸')) {
                        this.handleFrogClick(element);
                    }

                    // Hero poster clicks
                    if (element.closest('#heroPoster')) {
                        this.handlePosterClick();
                    }

                    // Timeline emoji clicks
                    if (element.classList.contains('timeline-emoji')) {
                        this.handleTimelineEmojiClick(element);
                    }

                    // Stats card clicks
                    if (element.closest('.stat-card')) {
                        this.handleStatsClick(element.closest('.stat-card'));
                    }
                });
            }

            setupKeySequences() {
                let keySequence = [];
                let emojiSequence = [];

                document.addEventListener('keydown', (e) => {
                    keySequence.push(e.code);
                    if (keySequence.length > 10) keySequence.shift();

                    this.checkSequences(keySequence, 'key');
                });

                // Track emoji inputs from meme generator
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('emoji-btn')) {
                        emojiSequence.push(e.target.textContent);
                        if (emojiSequence.length > 5) emojiSequence.shift();

                        this.checkSequences(emojiSequence, 'emoji');
                    }
                });
            }

            checkSequences(sequence, type) {
                Object.entries(this.sequences).forEach(([key, seq]) => {
                    const targetSequence = type === 'emoji' ? seq.sequence.filter(s => s.includes('🐸') || s.includes('💕') || s.includes('👮‍♂️')) : seq.sequence.filter(s => s.startsWith('Key') || s.startsWith('Arrow'));

                    if (targetSequence.length === 0) return;

                    const matches = targetSequence.every((item, index) => {
                        return sequence[sequence.length - targetSequence.length + index] === item;
                    });

                    if (matches && !this.discoveries.includes(key)) {
                        this.unlockEasterEgg(key, seq);
                    }
                });
            }

            handleFrogClick(element) {
                this.clickCounts.frog = (this.clickCounts.frog || 0) + 1;

                // Easter egg at 10 clicks
                if (this.clickCounts.frog === 10) {
                    this.unlockEasterEgg('frogLover', {
                        name: 'Frog Enthusiast',
                        reward: 'frogParty',
                        description: 'You really love frogs! 🐸'
                    });
                }

                // Create floating emoji
                this.createFloatingEmoji('🐸', element);
            }

            handlePosterClick() {
                this.clickCounts.poster = (this.clickCounts.poster || 0) + 1;

                if (this.clickCounts.poster === 5) {
                    this.unlockEasterEgg('posterFan', {
                        name: 'Poster Collector',
                        reward: 'posterGallery',
                        description: 'Unlock hidden poster variants!'
                    });
                }
            }

            handleTimelineEmojiClick(element) {
                const emoji = element.textContent;
                this.createFloatingEmoji(emoji, element);

                // Secret timeline progression
                this.clickCounts.timeline = (this.clickCounts.timeline || 0) + 1;
                if (this.clickCounts.timeline === 6) { // One for each timeline item
                    this.unlockEasterEgg('timelineMaster', {
                        name: 'Timeline Master',
                        reward: 'secretTimeline',
                        description: 'Unlock the secret timeline ending!'
                    });
                }
            }

            handleStatsClick(card) {
                const statNumber = card.querySelector('.stat-number').textContent;

                // Special handling for specific stats
                if (statNumber === '∞') {
                    this.unlockEasterEgg('infinite', {
                        name: 'Infinite Explorer',
                        reward: 'infiniteMode',
                        description: 'You found the infinite meme potential!'
                    });
                }
            }

            unlockEasterEgg(id, easterEgg) {
                if (this.discoveries.includes(id)) return;

                this.discoveries.push(id);
                localStorage.setItem('easterEggDiscoveries', JSON.stringify(this.discoveries));

                // Show discovery notification
                this.showDiscoveryNotification(easterEgg);

                // Activate the reward
                this.activateReward(easterEgg.reward);

                // Track discovery
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('easter_egg_discovered', {
                        eggId: id,
                        name: easterEgg.name
                    });
                }
            }

            showDiscoveryNotification(easterEgg) {
                const notification = document.createElement('div');
                notification.className = 'easter-egg-notification';
                notification.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-title">🥚 Easter Egg Discovered!</div>
                        <div class="notification-name">${easterEgg.name}</div>
                        <div class="notification-description">${easterEgg.description}</div>
                        <div class="notification-progress">${this.discoveries.length}/10 discovered</div>
                    </div>
                `;

                document.body.appendChild(notification);

                // Animate in
                setTimeout(() => notification.classList.add('show'), 100);

                // Remove after delay
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 500);
                }, 4000);
            }

            activateReward(rewardType) {
                switch (rewardType) {
                    case 'secretMode':
                        this.activateSecretMode();
                        break;
                    case 'romanticMode':
                        this.activateRomanticMode();
                        break;
                    case 'spicyMode':
                        this.activateSpicyMode();
                        break;
                    case 'frogParty':
                        this.activateFrogParty();
                        break;
                    case 'infiniteMode':
                        this.activateInfiniteMode();
                        break;
                }
            }

            activateSecretMode() {
                this.secretMode = true;
                document.body.classList.add('secret-mode');

                // Add secret style elements
                const style = document.createElement('style');
                style.id = 'secret-mode-styles';
                style.textContent = `
                    .secret-mode .timeline-emoji {
                        animation: secretSpin 2s linear infinite !important;
                    }
                    .secret-mode .hero h1 {
                        background: linear-gradient(45deg, #ff6b35, #f59e0b, #10b981, #3b82f6);
                        background-size: 400% 400%;
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        animation: secretGradient 3s ease infinite;
                    }
                    @keyframes secretSpin {
                        from { transform: rotate(0deg) scale(1); }
                        to { transform: rotate(360deg) scale(1.2); }
                    }
                    @keyframes secretGradient {
                        0%, 100% { background-position: 0% 50%; }
                        50% { background-position: 100% 50%; }
                    }
                `;
                document.head.appendChild(style);

                setTimeout(() => {
                    document.body.classList.remove('secret-mode');
                    document.getElementById('secret-mode-styles')?.remove();
                }, 10000);
            }

            activateRomanticMode() {
                // Create floating hearts
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        this.createFloatingEmoji('💕', document.body, {
                            x: Math.random() * window.innerWidth,
                            y: window.innerHeight,
                            duration: 3000
                        });
                    }, i * 200);
                }
            }

            activateSpicyMode() {
                // Replace all emojis temporarily with pepper spray
                const originalEmojis = [];
                document.querySelectorAll('.timeline-emoji, .stat-emoji-celebration').forEach(el => {
                    originalEmojis.push({ element: el, original: el.textContent });
                    el.textContent = '🌶️';
                });

                setTimeout(() => {
                    originalEmojis.forEach(({ element, original }) => {
                        element.textContent = original;
                    });
                }, 5000);
            }

            activateFrogParty() {
                // Massive frog explosion
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        this.createFloatingEmoji('🐸', document.body, {
                            x: Math.random() * window.innerWidth,
                            y: Math.random() * window.innerHeight,
                            duration: 2000,
                            size: Math.random() * 3 + 1
                        });
                    }, i * 100);
                }
            }

            activateInfiniteMode() {
                // Show secret message
                alert('🌌 You\'ve reached infinite meme potential! Reality is now optional. The frogs have achieved enlightenment. 🐸∞');
            }

            createFloatingEmoji(emoji, sourceElement, options = {}) {
                const floater = document.createElement('div');
                floater.className = 'floating-easter-emoji';
                floater.textContent = emoji;

                const rect = sourceElement.getBoundingClientRect();
                const startX = options.x !== undefined ? options.x : rect.left + rect.width / 2;
                const startY = options.y !== undefined ? options.y : rect.top + rect.height / 2;

                floater.style.cssText = `
                    position: fixed;
                    left: ${startX}px;
                    top: ${startY}px;
                    font-size: ${(options.size || 1) * 2}rem;
                    pointer-events: none;
                    z-index: 9999;
                    transition: all ${options.duration || 1500}ms ease-out;
                `;

                document.body.appendChild(floater);

                // Animate
                setTimeout(() => {
                    floater.style.transform = `translate(${(Math.random() - 0.5) * 200}px, -100px) rotate(360deg)`;
                    floater.style.opacity = '0';
                }, 50);

                // Remove
                setTimeout(() => floater.remove(), options.duration || 1500);
            }

            createDiscoveryTracker() {
                // Add discovery counter to UI
                const tracker = document.createElement('div');
                tracker.id = 'easter-egg-tracker';
                tracker.innerHTML = `
                    <div class="tracker-content">
                        🥚 <span id="discovery-count">${this.discoveries.length}</span>/10
                        <span class="tracker-separator">|</span>
                        📊 <span class="stats-btn" onclick="event.stopPropagation(); window.timelineSystem.showEngagementDashboard()">Stats</span>
                    </div>
                `;
                tracker.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 10px 15px;
                    border-radius: 20px;
                    font-size: 0.9rem;
                    z-index: 1000;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;

                tracker.addEventListener('click', () => this.showDiscoveryList());
                document.body.appendChild(tracker);
            }

            showDiscoveryList() {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'block';
                modal.innerHTML = `
                    <div class="modal-content easter-egg-modal">
                        <span class="close" onclick="this.closest('.modal').remove()">&times;</span>
                        <h2>🥚 Easter Egg Collection</h2>
                        <div class="discovery-grid">
                            ${this.generateDiscoveryList()}
                        </div>
                        <div class="easter-egg-hints">
                            <h3>💡 Hints for Hidden Eggs:</h3>
                            <ul>
                                <li>Try clicking on frogs... a lot 🐸</li>
                                <li>Use the meme generator emoji palette creatively 🎨</li>
                                <li>Explore the timeline thoroughly 📅</li>
                                <li>Some stats are more special than others ∞</li>
                                <li>Old school gamers know secret codes... ⬆️⬆️⬇️⬇️</li>
                            </ul>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            generateDiscoveryList() {
                const allEggs = {
                    frogLover: { name: 'Frog Enthusiast', description: 'Click frogs 10 times' },
                    posterFan: { name: 'Poster Collector', description: 'Click the hero poster 5 times' },
                    timelineMaster: { name: 'Timeline Master', description: 'Click all timeline emojis' },
                    infinite: { name: 'Infinite Explorer', description: 'Find the infinite stat' },
                    konami: { name: 'Secret Code Master', description: 'Enter the classic code' },
                    frogLove: { name: 'Love Sequence', description: 'Use emoji sequence correctly' },
                    spicy: { name: 'Spicy Code', description: 'Type the spicy word' }
                };

                return Object.entries(allEggs).map(([id, egg]) => {
                    const discovered = this.discoveries.includes(id);
                    return `
                        <div class="discovery-item ${discovered ? 'discovered' : 'hidden'}">
                            <div class="discovery-icon">${discovered ? '✅' : '❓'}</div>
                            <div class="discovery-name">${discovered ? egg.name : '???'}</div>
                            <div class="discovery-description">${discovered ? egg.description : 'Keep exploring...'}</div>
                        </div>
                    `;
                }).join('');
            }

            checkForSecretUnlocks() {
                // Unlock special features based on discovery count
                if (this.discoveries.length >= 5) {
                    // Unlock special meme template
                    if (window.memeGenerator) {
                        // Add secret template
                    }
                }

                if (this.discoveries.length >= 10) {
                    // Unlock ultimate secret
                    this.unlockUltimateSecret();
                }
            }

            unlockUltimateSecret() {
                alert('🎉 CONGRATULATIONS! You\'ve found all easter eggs! You are now officially a Frog & Fed Master Explorer! 🐸👮‍♂️💕');
            }
        }

        // Frog Pong Game Engine
        class FrogPongGame {
            constructor() {
                this.canvas = document.getElementById('frogPongCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.gameState = 'stopped'; // stopped, playing, paused
                this.score = 0;
                this.lives = 3;
                this.lastFrame = 0;
                this.keys = {};
                this.mouse = { x: 0, y: 0 };
                this.touch = { x: 0, y: 0, active: false };

                this.initGameObjects();
                this.setupControls();
                this.loadHighScore();
            }

            initGameObjects() {
                // Player paddle (left side)
                this.player = {
                    x: 20,
                    y: this.canvas.height / 2 - 50,
                    width: 15,
                    height: 100,
                    speed: 5,
                    color: '#00ff88'
                };

                // AI paddle (right side)
                this.ai = {
                    x: this.canvas.width - 35,
                    y: this.canvas.height / 2 - 50,
                    width: 15,
                    height: 100,
                    speed: 3,
                    color: '#ff6b35'
                };

                // Ball (frog)
                this.ball = {
                    x: this.canvas.width / 2,
                    y: this.canvas.height / 2,
                    width: 20,
                    height: 20,
                    speedX: 4,
                    speedY: 3,
                    emoji: '🐸'
                };

                this.powerUps = [];
                this.particles = [];
            }

            setupControls() {
                // Keyboard controls
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key.toLowerCase()] = true;
                });

                document.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;
                });

                // Mouse controls
                this.canvas.addEventListener('mousemove', (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    this.mouse.y = e.clientY - rect.top;
                });

                // Touch controls
                this.canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.touch.active = true;
                    const rect = this.canvas.getBoundingClientRect();
                    this.touch.y = e.touches[0].clientY - rect.top;
                });

                this.canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (this.touch.active) {
                        const rect = this.canvas.getBoundingClientRect();
                        this.touch.y = e.touches[0].clientY - rect.top;
                    }
                });

                this.canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    this.touch.active = false;
                });
            }

            start() {
                this.gameState = 'playing';
                this.lastFrame = performance.now();
                this.gameLoop();
                this.updateUI();

                // Track game start
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_started', {
                        game: 'frogPong',
                        timestamp: Date.now()
                    });
                }
            }

            pause() {
                this.gameState = this.gameState === 'paused' ? 'playing' : 'paused';
                if (this.gameState === 'playing') {
                    this.lastFrame = performance.now();
                    this.gameLoop();
                }
            }

            reset() {
                this.gameState = 'stopped';
                this.score = 0;
                this.lives = 3;
                this.initGameObjects();
                this.powerUps = [];
                this.particles = [];
                this.updateUI();
                this.draw();
            }

            gameLoop() {
                if (this.gameState !== 'playing') return;

                const currentTime = performance.now();
                const deltaTime = currentTime - this.lastFrame;
                this.lastFrame = currentTime;

                this.update(deltaTime);
                this.draw();

                requestAnimationFrame(() => this.gameLoop());
            }

            update(deltaTime) {
                this.updatePlayer();
                this.updateAI();
                this.updateBall();
                this.updatePowerUps(deltaTime);
                this.updateParticles(deltaTime);
                this.checkCollisions();
                this.spawnPowerUps();
            }

            updatePlayer() {
                // Keyboard controls
                if (this.keys['w'] || this.keys['arrowup']) {
                    this.player.y -= this.player.speed;
                }
                if (this.keys['s'] || this.keys['arrowdown']) {
                    this.player.y += this.player.speed;
                }

                // Mouse controls
                if (this.mouse.y > 0) {
                    this.player.y = this.mouse.y - this.player.height / 2;
                }

                // Touch controls
                if (this.touch.active) {
                    this.player.y = this.touch.y - this.player.height / 2;
                }

                // Keep paddle in bounds
                this.player.y = Math.max(0, Math.min(this.canvas.height - this.player.height, this.player.y));
            }

            updateAI() {
                // Simple AI: follow the ball with some lag
                const ballCenter = this.ball.y + this.ball.height / 2;
                const paddleCenter = this.ai.y + this.ai.height / 2;

                if (ballCenter < paddleCenter - 10) {
                    this.ai.y -= this.ai.speed;
                } else if (ballCenter > paddleCenter + 10) {
                    this.ai.y += this.ai.speed;
                }

                // Keep AI paddle in bounds
                this.ai.y = Math.max(0, Math.min(this.canvas.height - this.ai.height, this.ai.y));
            }

            updateBall() {
                this.ball.x += this.ball.speedX;
                this.ball.y += this.ball.speedY;

                // Bounce off top and bottom walls
                if (this.ball.y <= 0 || this.ball.y >= this.canvas.height - this.ball.height) {
                    this.ball.speedY = -this.ball.speedY;
                    this.createParticles(this.ball.x, this.ball.y, '💥');
                }

                // Check if ball went off screen
                if (this.ball.x < -this.ball.width) {
                    this.lives--;
                    this.resetBall();
                    this.createParticles(this.ball.x, this.ball.y, '💔');
                } else if (this.ball.x > this.canvas.width) {
                    this.score += 10;
                    this.resetBall();
                    this.createParticles(this.ball.x, this.ball.y, '🎉');
                }

                // Check game over
                if (this.lives <= 0) {
                    this.gameOver();
                }

                this.updateUI();
            }

            checkCollisions() {
                // Player paddle collision
                if (this.ball.x <= this.player.x + this.player.width &&
                    this.ball.x + this.ball.width >= this.player.x &&
                    this.ball.y <= this.player.y + this.player.height &&
                    this.ball.y + this.ball.height >= this.player.y) {

                    this.ball.speedX = Math.abs(this.ball.speedX);
                    this.ball.x = this.player.x + this.player.width;
                    this.score += 1;
                    this.createParticles(this.ball.x, this.ball.y, '💕');
                }

                // AI paddle collision
                if (this.ball.x + this.ball.width >= this.ai.x &&
                    this.ball.x <= this.ai.x + this.ai.width &&
                    this.ball.y <= this.ai.y + this.ai.height &&
                    this.ball.y + this.ball.height >= this.ai.y) {

                    this.ball.speedX = -Math.abs(this.ball.speedX);
                    this.ball.x = this.ai.x - this.ball.width;
                    this.createParticles(this.ball.x, this.ball.y, '⚡');
                }

                // Power-up collisions
                this.powerUps.forEach((powerUp, index) => {
                    if (this.ball.x < powerUp.x + 30 &&
                        this.ball.x + this.ball.width > powerUp.x &&
                        this.ball.y < powerUp.y + 30 &&
                        this.ball.y + this.ball.height > powerUp.y) {

                        this.collectPowerUp(powerUp);
                        this.powerUps.splice(index, 1);
                    }
                });
            }

            spawnPowerUps() {
                if (Math.random() < 0.001) { // 0.1% chance per frame
                    const powerUpTypes = ['💕', '🌶️', '👁️'];
                    const type = powerUpTypes[Math.floor(Math.random() * powerUpTypes.length)];

                    this.powerUps.push({
                        x: Math.random() * (this.canvas.width - 100) + 50,
                        y: Math.random() * (this.canvas.height - 100) + 50,
                        type: type,
                        lifetime: 5000 // 5 seconds
                    });
                }
            }

            collectPowerUp(powerUp) {
                switch (powerUp.type) {
                    case '💕': // Heart - Extra life
                        this.lives++;
                        break;
                    case '🌶️': // Spicy - Speed boost
                        this.ball.speedX *= 1.5;
                        this.ball.speedY *= 1.5;
                        setTimeout(() => {
                            this.ball.speedX /= 1.5;
                            this.ball.speedY /= 1.5;
                        }, 3000);
                        break;
                    case '👁️': // Googly - Bigger paddle
                        this.player.height *= 1.5;
                        setTimeout(() => {
                            this.player.height /= 1.5;
                        }, 5000);
                        break;
                }

                this.createParticles(powerUp.x + 15, powerUp.y + 15, powerUp.type);
                this.score += 5;
            }

            updatePowerUps(deltaTime) {
                this.powerUps.forEach((powerUp, index) => {
                    powerUp.lifetime -= deltaTime;
                    if (powerUp.lifetime <= 0) {
                        this.powerUps.splice(index, 1);
                    }
                });
            }

            createParticles(x, y, emoji) {
                for (let i = 0; i < 5; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        speedX: (Math.random() - 0.5) * 4,
                        speedY: (Math.random() - 0.5) * 4,
                        emoji: emoji,
                        life: 1000 // 1 second
                    });
                }
            }

            updateParticles(deltaTime) {
                this.particles.forEach((particle, index) => {
                    particle.x += particle.speedX;
                    particle.y += particle.speedY;
                    particle.life -= deltaTime;

                    if (particle.life <= 0) {
                        this.particles.splice(index, 1);
                    }
                });
            }

            resetBall() {
                this.ball.x = this.canvas.width / 2;
                this.ball.y = this.canvas.height / 2;
                this.ball.speedX = (Math.random() > 0.5 ? 1 : -1) * 4;
                this.ball.speedY = (Math.random() - 0.5) * 6;
            }

            draw() {
                // Clear canvas
                this.ctx.fillStyle = '#000';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                // Draw center line
                this.ctx.strokeStyle = '#333';
                this.ctx.setLineDash([10, 10]);
                this.ctx.beginPath();
                this.ctx.moveTo(this.canvas.width / 2, 0);
                this.ctx.lineTo(this.canvas.width / 2, this.canvas.height);
                this.ctx.stroke();
                this.ctx.setLineDash([]);

                // Draw paddles
                this.ctx.fillStyle = this.player.color;
                this.ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);

                this.ctx.fillStyle = this.ai.color;
                this.ctx.fillRect(this.ai.x, this.ai.y, this.ai.width, this.ai.height);

                // Draw ball (frog emoji)
                this.ctx.font = '24px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText(this.ball.emoji, this.ball.x + this.ball.width/2, this.ball.y + this.ball.height);

                // Draw power-ups
                this.ctx.font = '30px Arial';
                this.powerUps.forEach(powerUp => {
                    const alpha = Math.sin(Date.now() / 200) * 0.3 + 0.7; // Pulsing effect
                    this.ctx.globalAlpha = alpha;
                    this.ctx.fillText(powerUp.type, powerUp.x + 15, powerUp.y + 25);
                });
                this.ctx.globalAlpha = 1;

                // Draw particles
                this.ctx.font = '16px Arial';
                this.particles.forEach(particle => {
                    const alpha = particle.life / 1000;
                    this.ctx.globalAlpha = alpha;
                    this.ctx.fillText(particle.emoji, particle.x, particle.y);
                });
                this.ctx.globalAlpha = 1;

                // Draw pause overlay
                if (this.gameState === 'paused') {
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    this.ctx.fillStyle = '#fff';
                    this.ctx.font = '48px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText('PAUSED', this.canvas.width / 2, this.canvas.height / 2);
                }
            }

            updateUI() {
                document.getElementById('gameScore').textContent = this.score;
                document.getElementById('gameLives').textContent = this.lives;
            }

            gameOver() {
                this.gameState = 'stopped';

                // Update high score
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('frogPongHighScore', this.score);
                    document.getElementById('frogPongHighScore').textContent = this.score;
                }

                // Track game completion
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_completed', {
                        game: 'frogPong',
                        score: this.score,
                        isHighScore: this.score === this.highScore
                    });
                }

                // Show game over message
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.fillStyle = '#fff';
                this.ctx.font = '48px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('GAME OVER', this.canvas.width / 2, this.canvas.height / 2 - 30);
                this.ctx.font = '24px Arial';
                this.ctx.fillText(`Final Score: ${this.score}`, this.canvas.width / 2, this.canvas.height / 2 + 20);

                if (this.score === this.highScore) {
                    this.ctx.fillStyle = '#ffd700';
                    this.ctx.fillText('NEW HIGH SCORE! 🏆', this.canvas.width / 2, this.canvas.height / 2 + 50);
                }
            }

            loadHighScore() {
                this.highScore = parseInt(localStorage.getItem('frogPongHighScore') || '0');
                document.getElementById('frogPongHighScore').textContent = this.highScore;
            }
        }

        // Global game functions
        function launchFrogPong() {
            const modal = document.getElementById('frogPongModal');
            modal.style.display = 'block';
            if (!window.frogPongGame) {
                window.frogPongGame = new FrogPongGame();
            }
            window.frogPongGame.draw();

            // Add click-outside-to-close functionality
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeFrogPong();
                }
            });
        }

        function closeFrogPong() {
            document.getElementById('frogPongModal').style.display = 'none';
            if (window.frogPongGame) {
                window.frogPongGame.gameState = 'stopped';
            }
        }

        function startFrogPong() {
            if (window.frogPongGame) {
                window.frogPongGame.start();
                document.getElementById('startGameBtn').style.display = 'none';
                document.getElementById('pauseGameBtn').style.display = 'inline-block';
            }
        }

        function pauseFrogPong() {
            if (window.frogPongGame) {
                window.frogPongGame.pause();
                const pauseBtn = document.getElementById('pauseGameBtn');
                pauseBtn.textContent = window.frogPongGame.gameState === 'paused' ? '▶️ Resume' : '⏸️ Pause';
            }
        }

        function resetFrogPong() {
            if (window.frogPongGame) {
                window.frogPongGame.reset();
                document.getElementById('startGameBtn').style.display = 'inline-block';
                document.getElementById('pauseGameBtn').style.display = 'none';
                document.getElementById('pauseGameBtn').textContent = '⏸️ Pause';
            }
        }

        // Tear Gas Tetris Game
        class TetrisGame {
            constructor() {
                this.canvas = document.getElementById('tetrisCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.nextCanvas = document.getElementById('nextPieceCanvas');
                this.nextCtx = this.nextCanvas.getContext('2d');

                this.gameState = 'stopped'; // stopped, playing, paused
                this.score = 0;
                this.level = 1;
                this.lines = 0;
                this.highScore = 0;

                this.blockSize = 30;
                this.gridWidth = 10;
                this.gridHeight = 20;
                this.grid = [];

                this.currentPiece = null;
                this.nextPiece = null;
                this.dropTimer = 0;
                this.dropSpeed = 1000; // milliseconds
                this.lastDrop = 0;

                this.pieces = this.initializePieces();
                this.specialPowerActive = null;
                this.specialPowerTimer = 0;

                this.touchStartY = null;
                this.touchStartX = null;

                this.init();
                this.bindEvents();
                this.loadHighScore();
            }

            initializePieces() {
                return {
                    // Gas Mask (T-piece)
                    gasMask: {
                        emoji: '😷',
                        shape: [
                            [0, 1, 0],
                            [1, 1, 1],
                            [0, 0, 0]
                        ],
                        color: '#4a5568'
                    },
                    // Shield (O-piece)
                    shield: {
                        emoji: '🛡️',
                        shape: [
                            [1, 1],
                            [1, 1]
                        ],
                        color: '#2563eb'
                    },
                    // Baton (I-piece)
                    baton: {
                        emoji: '🚔',
                        shape: [
                            [0, 0, 0, 0],
                            [1, 1, 1, 1],
                            [0, 0, 0, 0],
                            [0, 0, 0, 0]
                        ],
                        color: '#1f2937'
                    },
                    // Helmet (L-piece)
                    helmet: {
                        emoji: '⛑️',
                        shape: [
                            [1, 0, 0],
                            [1, 0, 0],
                            [1, 1, 0]
                        ],
                        color: '#dc2626'
                    },
                    // Vest (J-piece)
                    vest: {
                        emoji: '🦺',
                        shape: [
                            [0, 0, 1],
                            [0, 0, 1],
                            [0, 1, 1]
                        ],
                        color: '#f59e0b'
                    },
                    // Boot (S-piece)
                    boot: {
                        emoji: '🥾',
                        shape: [
                            [0, 1, 1],
                            [1, 1, 0],
                            [0, 0, 0]
                        ],
                        color: '#84cc16'
                    },
                    // Glove (Z-piece)
                    glove: {
                        emoji: '🧤',
                        shape: [
                            [1, 1, 0],
                            [0, 1, 1],
                            [0, 0, 0]
                        ],
                        color: '#8b5cf6'
                    },
                    // Special pieces
                    frog: {
                        emoji: '🐸',
                        shape: [[1]],
                        color: '#10b981',
                        special: 'clearRow'
                    },
                    officer: {
                        emoji: '👮‍♂️',
                        shape: [[1]],
                        color: '#3b82f6',
                        special: 'slowTime'
                    },
                    heart: {
                        emoji: '💕',
                        shape: [[1]],
                        color: '#ec4899',
                        special: 'bonusPoints'
                    }
                };
            }

            init() {
                // Initialize grid
                this.grid = Array(this.gridHeight).fill(null).map(() =>
                    Array(this.gridWidth).fill(null)
                );

                // Set canvas size
                this.canvas.width = this.gridWidth * this.blockSize;
                this.canvas.height = this.gridHeight * this.blockSize;
                this.nextCanvas.width = 4 * this.blockSize;
                this.nextCanvas.height = 4 * this.blockSize;
            }

            bindEvents() {
                // Keyboard controls
                document.addEventListener('keydown', (e) => {
                    if (this.gameState !== 'playing') return;

                    switch(e.key) {
                        case 'ArrowLeft':
                            this.movePiece(-1, 0);
                            break;
                        case 'ArrowRight':
                            this.movePiece(1, 0);
                            break;
                        case 'ArrowDown':
                            this.softDrop();
                            break;
                        case 'ArrowUp':
                        case ' ':
                            this.rotatePiece();
                            break;
                    }
                });

                // Touch controls
                this.canvas.addEventListener('touchstart', (e) => {
                    if (this.gameState !== 'playing') return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    this.touchStartX = touch.clientX;
                    this.touchStartY = touch.clientY;
                });

                this.canvas.addEventListener('touchmove', (e) => {
                    if (this.gameState !== 'playing' || !this.touchStartX) return;
                    e.preventDefault();

                    const touch = e.touches[0];
                    const deltaX = touch.clientX - this.touchStartX;
                    const deltaY = touch.clientY - this.touchStartY;

                    if (Math.abs(deltaX) > 30) {
                        this.movePiece(deltaX > 0 ? 1 : -1, 0);
                        this.touchStartX = touch.clientX;
                    }

                    if (deltaY > 50) {
                        this.softDrop();
                        this.touchStartY = touch.clientY;
                    }
                });

                this.canvas.addEventListener('touchend', (e) => {
                    if (this.gameState !== 'playing') return;
                    e.preventDefault();
                    this.touchStartX = null;
                    this.touchStartY = null;
                });
            }

            start() {
                this.gameState = 'playing';
                this.score = 0;
                this.level = 1;
                this.lines = 0;
                this.dropSpeed = 1000;
                this.init();

                this.spawnPiece();
                this.generateNextPiece();
                this.gameLoop();

                // Update UI
                document.getElementById('tetrisScore').textContent = this.score;
                document.getElementById('tetrisLevel').textContent = this.level;
                document.getElementById('tetrisLines').textContent = this.lines;

                // Track game start
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_started', {
                        game: 'tearGasTetris'
                    });
                }
            }

            pause() {
                if (this.gameState === 'playing') {
                    this.gameState = 'paused';
                } else if (this.gameState === 'paused') {
                    this.gameState = 'playing';
                    this.gameLoop();
                }
            }

            reset() {
                this.gameState = 'stopped';
                this.score = 0;
                this.level = 1;
                this.lines = 0;
                this.init();
                this.draw();
            }

            spawnPiece() {
                const pieceTypes = Object.keys(this.pieces).filter(type =>
                    !this.pieces[type].special
                );

                // 5% chance for special piece
                if (Math.random() < 0.05) {
                    const specials = ['frog', 'officer', 'heart'];
                    const type = specials[Math.floor(Math.random() * specials.length)];
                    this.nextPiece = {
                        type: type,
                        ...this.pieces[type],
                        x: Math.floor(this.gridWidth / 2) - Math.floor(this.pieces[type].shape[0].length / 2),
                        y: 0,
                        rotation: 0
                    };
                } else {
                    const type = pieceTypes[Math.floor(Math.random() * pieceTypes.length)];
                    this.nextPiece = {
                        type: type,
                        ...this.pieces[type],
                        x: Math.floor(this.gridWidth / 2) - Math.floor(this.pieces[type].shape[0].length / 2),
                        y: 0,
                        rotation: 0
                    };
                }
            }

            generateNextPiece() {
                if (this.nextPiece) {
                    this.currentPiece = this.nextPiece;
                    this.spawnPiece();
                    this.drawNextPiece();

                    // Check for game over
                    if (this.checkCollision(this.currentPiece)) {
                        this.gameOver();
                    }
                } else {
                    this.spawnPiece();
                    this.generateNextPiece();
                }
            }

            movePiece(dx, dy) {
                if (!this.currentPiece) return;

                const newPiece = {
                    ...this.currentPiece,
                    x: this.currentPiece.x + dx,
                    y: this.currentPiece.y + dy
                };

                if (!this.checkCollision(newPiece)) {
                    this.currentPiece = newPiece;
                    return true;
                }
                return false;
            }

            rotatePiece() {
                if (!this.currentPiece || this.currentPiece.special) return;

                const rotatedShape = this.rotateMatrix(this.currentPiece.shape);
                const newPiece = {
                    ...this.currentPiece,
                    shape: rotatedShape,
                    rotation: (this.currentPiece.rotation + 90) % 360
                };

                if (!this.checkCollision(newPiece)) {
                    this.currentPiece = newPiece;
                }
            }

            rotateMatrix(matrix) {
                const n = matrix.length;
                const rotated = Array(n).fill(null).map(() => Array(n).fill(0));

                for (let i = 0; i < n; i++) {
                    for (let j = 0; j < n; j++) {
                        rotated[j][n - 1 - i] = matrix[i][j];
                    }
                }

                return rotated;
            }

            softDrop() {
                if (this.movePiece(0, 1)) {
                    this.score += 1;
                    document.getElementById('tetrisScore').textContent = this.score;
                }
            }

            hardDrop() {
                let dropped = 0;
                while (this.movePiece(0, 1)) {
                    dropped++;
                }
                this.score += dropped * 2;
                document.getElementById('tetrisScore').textContent = this.score;
                this.lockPiece();
            }

            checkCollision(piece) {
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x]) {
                            const newX = piece.x + x;
                            const newY = piece.y + y;

                            if (newX < 0 || newX >= this.gridWidth ||
                                newY >= this.gridHeight ||
                                (newY >= 0 && this.grid[newY][newX])) {
                                return true;
                            }
                        }
                    }
                }
                return false;
            }

            lockPiece() {
                if (!this.currentPiece) return;

                // Handle special pieces
                if (this.currentPiece.special) {
                    this.activateSpecialPower(this.currentPiece.special);
                } else {
                    // Lock normal piece to grid
                    for (let y = 0; y < this.currentPiece.shape.length; y++) {
                        for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                            if (this.currentPiece.shape[y][x]) {
                                const gridY = this.currentPiece.y + y;
                                const gridX = this.currentPiece.x + x;

                                if (gridY >= 0) {
                                    this.grid[gridY][gridX] = {
                                        color: this.currentPiece.color,
                                        emoji: this.currentPiece.emoji
                                    };
                                }
                            }
                        }
                    }
                }

                // Check for completed lines
                this.checkLines();

                // Spawn next piece
                this.generateNextPiece();
            }

            activateSpecialPower(power) {
                switch(power) {
                    case 'clearRow':
                        // Clear the row where the frog landed
                        const row = Math.min(this.currentPiece.y, this.gridHeight - 1);
                        this.grid[row] = Array(this.gridWidth).fill(null);
                        this.score += 100;
                        this.showPowerMessage('🐸 Frog Power! Row Cleared!');
                        break;

                    case 'slowTime':
                        // Slow down drop speed for 10 seconds
                        this.specialPowerActive = 'slowTime';
                        this.specialPowerTimer = 10000;
                        this.dropSpeed *= 2;
                        this.showPowerMessage('👮‍♂️ Time Slowed!');
                        break;

                    case 'bonusPoints':
                        // Award bonus points
                        this.score += 500;
                        this.showPowerMessage('💕 Love Bonus! +500');
                        break;
                }

                document.getElementById('tetrisScore').textContent = this.score;
            }

            showPowerMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'power-message';
                messageDiv.textContent = message;
                messageDiv.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(255, 215, 0, 0.9);
                    color: #000;
                    padding: 10px 20px;
                    border-radius: 10px;
                    font-size: 20px;
                    font-weight: bold;
                    z-index: 1000;
                    animation: fadeOut 2s ease-out forwards;
                `;

                this.canvas.parentElement.appendChild(messageDiv);
                setTimeout(() => messageDiv.remove(), 2000);
            }

            checkLines() {
                const linesToClear = [];

                for (let y = 0; y < this.gridHeight; y++) {
                    if (this.grid[y].every(cell => cell !== null)) {
                        linesToClear.push(y);
                    }
                }

                if (linesToClear.length > 0) {
                    this.clearLines(linesToClear);
                    this.updateScore(linesToClear.length);
                    this.updateLevel();
                }
            }

            clearLines(lines) {
                // Animate line clearing
                lines.forEach(y => {
                    for (let x = 0; x < this.gridWidth; x++) {
                        this.grid[y][x] = { color: '#ffd700', emoji: '✨' };
                    }
                });

                // Remove cleared lines and add new ones at top
                setTimeout(() => {
                    lines.sort((a, b) => b - a).forEach(y => {
                        this.grid.splice(y, 1);
                        this.grid.unshift(Array(this.gridWidth).fill(null));
                    });
                }, 100);

                this.lines += lines.length;
                document.getElementById('tetrisLines').textContent = this.lines;
            }

            updateScore(linesCleared) {
                const baseScore = [0, 100, 300, 500, 800];
                this.score += baseScore[linesCleared] * this.level;
                document.getElementById('tetrisScore').textContent = this.score;
            }

            updateLevel() {
                const newLevel = Math.floor(this.lines / 10) + 1;
                if (newLevel > this.level) {
                    this.level = newLevel;
                    this.dropSpeed = Math.max(100, 1000 - (this.level - 1) * 100);
                    document.getElementById('tetrisLevel').textContent = this.level;
                }
            }

            gameLoop() {
                if (this.gameState !== 'playing') return;

                const now = Date.now();
                const deltaTime = now - this.lastDrop;

                // Handle special power timers
                if (this.specialPowerActive && this.specialPowerTimer > 0) {
                    this.specialPowerTimer -= deltaTime;
                    if (this.specialPowerTimer <= 0) {
                        if (this.specialPowerActive === 'slowTime') {
                            this.dropSpeed /= 2;
                        }
                        this.specialPowerActive = null;
                    }
                }

                // Auto drop
                if (deltaTime > this.dropSpeed) {
                    if (!this.movePiece(0, 1)) {
                        this.lockPiece();
                    }
                    this.lastDrop = now;
                }

                this.draw();
                requestAnimationFrame(() => this.gameLoop());
            }

            draw() {
                // Clear canvas
                this.ctx.fillStyle = '#1a1a2e';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                // Draw grid
                this.ctx.strokeStyle = '#333';
                this.ctx.lineWidth = 0.5;

                for (let x = 0; x <= this.gridWidth; x++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(x * this.blockSize, 0);
                    this.ctx.lineTo(x * this.blockSize, this.canvas.height);
                    this.ctx.stroke();
                }

                for (let y = 0; y <= this.gridHeight; y++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(0, y * this.blockSize);
                    this.ctx.lineTo(this.canvas.width, y * this.blockSize);
                    this.ctx.stroke();
                }

                // Draw locked pieces
                for (let y = 0; y < this.gridHeight; y++) {
                    for (let x = 0; x < this.gridWidth; x++) {
                        if (this.grid[y][x]) {
                            this.drawBlock(x, y, this.grid[y][x].color, this.grid[y][x].emoji);
                        }
                    }
                }

                // Draw current piece
                if (this.currentPiece) {
                    for (let y = 0; y < this.currentPiece.shape.length; y++) {
                        for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                            if (this.currentPiece.shape[y][x]) {
                                this.drawBlock(
                                    this.currentPiece.x + x,
                                    this.currentPiece.y + y,
                                    this.currentPiece.color,
                                    this.currentPiece.emoji
                                );
                            }
                        }
                    }
                }

                // Draw special power indicator
                if (this.specialPowerActive) {
                    this.ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                }
            }

            drawBlock(x, y, color, emoji) {
                // Draw block background
                this.ctx.fillStyle = color;
                this.ctx.fillRect(
                    x * this.blockSize,
                    y * this.blockSize,
                    this.blockSize - 1,
                    this.blockSize - 1
                );

                // Draw emoji
                this.ctx.font = `${this.blockSize * 0.7}px Arial`;
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                this.ctx.fillText(
                    emoji,
                    x * this.blockSize + this.blockSize / 2,
                    y * this.blockSize + this.blockSize / 2
                );
            }

            drawNextPiece() {
                // Clear next piece canvas
                this.nextCtx.fillStyle = '#1a1a2e';
                this.nextCtx.fillRect(0, 0, this.nextCanvas.width, this.nextCanvas.height);

                if (!this.nextPiece) return;

                // Center the piece in the preview
                const offsetX = (4 - this.nextPiece.shape[0].length) / 2;
                const offsetY = (4 - this.nextPiece.shape.length) / 2;

                for (let y = 0; y < this.nextPiece.shape.length; y++) {
                    for (let x = 0; x < this.nextPiece.shape[y].length; x++) {
                        if (this.nextPiece.shape[y][x]) {
                            const drawX = (offsetX + x) * this.blockSize;
                            const drawY = (offsetY + y) * this.blockSize;

                            // Draw block
                            this.nextCtx.fillStyle = this.nextPiece.color;
                            this.nextCtx.fillRect(drawX, drawY, this.blockSize - 1, this.blockSize - 1);

                            // Draw emoji
                            this.nextCtx.font = `${this.blockSize * 0.7}px Arial`;
                            this.nextCtx.textAlign = 'center';
                            this.nextCtx.textBaseline = 'middle';
                            this.nextCtx.fillText(
                                this.nextPiece.emoji,
                                drawX + this.blockSize / 2,
                                drawY + this.blockSize / 2
                            );
                        }
                    }
                }
            }

            gameOver() {
                this.gameState = 'stopped';

                // Update high score
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('tetrisHighScore', this.score);
                    document.getElementById('tetrisHighScore').textContent = this.score;
                }

                // Track game completion
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_completed', {
                        game: 'tearGasTetris',
                        score: this.score,
                        level: this.level,
                        lines: this.lines,
                        isHighScore: this.score === this.highScore
                    });
                }

                // Show game over screen
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                this.ctx.fillStyle = '#fff';
                this.ctx.font = 'bold 36px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('GAME OVER', this.canvas.width / 2, this.canvas.height / 2 - 60);

                this.ctx.font = '20px Arial';
                this.ctx.fillText(`Score: ${this.score}`, this.canvas.width / 2, this.canvas.height / 2);
                this.ctx.fillText(`Level: ${this.level}`, this.canvas.width / 2, this.canvas.height / 2 + 30);
                this.ctx.fillText(`Lines: ${this.lines}`, this.canvas.width / 2, this.canvas.height / 2 + 60);

                if (this.score === this.highScore) {
                    this.ctx.fillStyle = '#ffd700';
                    this.ctx.font = 'bold 24px Arial';
                    this.ctx.fillText('NEW HIGH SCORE! 🏆', this.canvas.width / 2, this.canvas.height / 2 + 100);
                }
            }

            loadHighScore() {
                this.highScore = parseInt(localStorage.getItem('tetrisHighScore') || '0');
                document.getElementById('tetrisHighScore').textContent = this.highScore;
            }
        }

        // Tetris game control functions
        function launchTetris() {
            const modal = document.getElementById('tetrisModal');
            modal.style.display = 'block';
            if (!window.tetrisGame) {
                window.tetrisGame = new TetrisGame();
            }
            window.tetrisGame.draw();

            // Add click-outside-to-close functionality
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeTetris();
                }
            });
        }

        function closeTetris() {
            document.getElementById('tetrisModal').style.display = 'none';
            if (window.tetrisGame) {
                window.tetrisGame.gameState = 'stopped';
            }
        }

        function startTetris() {
            if (window.tetrisGame) {
                window.tetrisGame.start();
                document.getElementById('startTetrisBtn').style.display = 'none';
                document.getElementById('pauseTetrisBtn').style.display = 'inline-block';
            }
        }

        function pauseTetris() {
            if (window.tetrisGame) {
                window.tetrisGame.pause();
                const pauseBtn = document.getElementById('pauseTetrisBtn');
                pauseBtn.textContent = window.tetrisGame.gameState === 'paused' ? '▶️ Resume' : '⏸️ Pause';
            }
        }

        function resetTetris() {
            if (window.tetrisGame) {
                window.tetrisGame.reset();
                document.getElementById('startTetrisBtn').style.display = 'inline-block';
                document.getElementById('pauseTetrisBtn').style.display = 'none';
                document.getElementById('pauseTetrisBtn').textContent = '⏸️ Pause';
            }
        }

        function moveTetrisLeft() {
            if (window.tetrisGame && window.tetrisGame.gameState === 'playing') {
                window.tetrisGame.movePiece(-1, 0);
            }
        }

        function moveTetrisRight() {
            if (window.tetrisGame && window.tetrisGame.gameState === 'playing') {
                window.tetrisGame.movePiece(1, 0);
            }
        }

        function rotateTetris() {
            if (window.tetrisGame && window.tetrisGame.gameState === 'playing') {
                window.tetrisGame.rotatePiece();
            }
        }

        function dropTetris() {
            if (window.tetrisGame && window.tetrisGame.gameState === 'playing') {
                window.tetrisGame.hardDrop();
            }
        }

        // Romance Simulator Game
        class RomanceSimulator {
            constructor() {
                this.gameState = 'stopped';
                this.currentChapter = 1;
                this.romance = 0;
                this.tension = 50;
                this.understanding = 0;
                this.currentStoryNode = 'start';
                this.visitedNodes = new Set();
                this.bestEnding = localStorage.getItem('romanceBestEnding') || 'None';
                this.musicEnabled = localStorage.getItem('romanceMusic') === 'true';

                this.storyData = this.initializeStoryData();
                this.loadBestEnding();
            }

            initializeStoryData() {
                return {
                    start: {
                        text: "Portland, 2025. Rain drizzles on the protest camp. Seth adjusts his inflatable frog costume as Officer Martinez approaches through the mist...",
                        speaker: "Narrator",
                        choices: [
                            { text: "🐸 Playfully hop away", next: "playful_hop", romance: +5, tension: -10 },
                            { text: "😤 Stand your ground defiantly", next: "defiant_stand", tension: +15, understanding: -5 },
                            { text: "🤝 Calmly introduce yourself", next: "calm_intro", understanding: +10, tension: -5 }
                        ],
                        background: "protest"
                    },
                    playful_hop: {
                        text: "Your playful bouncing catches Martinez off guard. A small smile cracks their stern expression as you perform an elaborate frog dance.",
                        speaker: "Martinez",
                        dialogue: "\"Okay, that's... actually kind of cute. But you still can't block the entrance.\"",
                        choices: [
                            { text: "💃 Invite them to dance", next: "dance_invite", romance: +15, tension: -10 },
                            { text: "🎭 Explain the performance art", next: "art_explanation", understanding: +10 },
                            { text: "😏 Suggest a compromise", next: "compromise_attempt", understanding: +5, romance: +5 }
                        ],
                        background: "playful"
                    },
                    defiant_stand: {
                        text: "You inflate even more, becoming a magnificent green sphere of resistance. Martinez's jaw tightens, but there's something else in their eyes...",
                        speaker: "Martinez",
                        dialogue: "\"You're either very brave or very stupid. I haven't decided which.\"",
                        choices: [
                            { text: "🔥 'Why not both?'", next: "brave_stupid", romance: +10, tension: +5 },
                            { text: "📝 Quote civil disobedience", next: "philosophy_quote", understanding: +15 },
                            { text: "👀 Stare intensely", next: "intense_stare", romance: +5, tension: +10 }
                        ],
                        background: "tense"
                    },
                    calm_intro: {
                        text: "You deflate slightly and extend a green mitt. 'Seth Todd, professional silly person. You are?'",
                        speaker: "Martinez",
                        dialogue: "\"Officer Martinez. And this is... not what I expected from today's shift.\"",
                        choices: [
                            { text: "☕ 'Coffee break conversation?'", next: "coffee_suggestion", romance: +10, understanding: +10 },
                            { text: "🎪 'Life's full of surprises!'", next: "surprise_philosophy", understanding: +5, romance: +5 },
                            { text: "🤔 'What did you expect?'", next: "expectation_question", understanding: +15 }
                        ],
                        background: "neutral"
                    },
                    dance_invite: {
                        text: "Martinez hesitates, glances around, then awkwardly attempts a small step. Other officers watch in bewilderment.",
                        speaker: "Martinez",
                        dialogue: "\"I... this is highly irregular. But it's been a long week.\"",
                        choices: [
                            { text: "🎶 'Dance makes everything better'", next: "dance_philosophy", romance: +20, understanding: +10 },
                            { text: "🤐 Say nothing, just dance", next: "silent_dance", romance: +15, tension: -20 },
                            { text: "😄 'You're a natural!'", next: "compliment_dancing", romance: +10, understanding: +5 }
                        ],
                        background: "romantic"
                    },
                    coffee_suggestion: {
                        text: "Twenty minutes later, you're sitting in a 24-hour diner, frog costume dripping on the vinyl booth.",
                        speaker: "Martinez",
                        dialogue: "\"So... why a frog? I mean, really why?\"",
                        choices: [
                            { text: "🌊 'Frogs adapt to any environment'", next: "adaptation_metaphor", understanding: +15, romance: +5 },
                            { text: "😂 'Makes people smile in dark times'", next: "joy_mission", romance: +10, understanding: +10 },
                            { text: "💭 'What makes you a cop?'", next: "reverse_question", understanding: +20 }
                        ],
                        background: "intimate"
                    },
                    dance_philosophy: {
                        text: "As you both move awkwardly to imaginary music, the absurdity breaks down walls. Other protesters and officers watch the surreal scene.",
                        speaker: "Martinez",
                        dialogue: "\"You know, in another life, I might have been at these protests myself.\"",
                        choices: [
                            { text: "💫 'It's never too late'", next: "never_too_late", romance: +25, understanding: +15 },
                            { text: "❓ 'What changed?'", next: "what_changed", understanding: +20 },
                            { text: "🤗 'You're here now'", next: "present_moment", romance: +15, understanding: +10 }
                        ],
                        background: "breakthrough"
                    },
                    never_too_late: {
                        text: "Martinez stops dancing, looks directly at you through the frog costume's googly eyes. Rain starts falling harder.",
                        speaker: "Martinez",
                        dialogue: "\"You're dangerous, you know that? Making me think about things I've buried.\"",
                        choices: [
                            { text: "💕 'The best people usually are'", next: "ending_romance", romance: +30 },
                            { text: "🌟 'Change is beautiful'", next: "ending_transformation", understanding: +25 },
                            { text: "🌧️ 'Want to get coffee again?'", next: "ending_friendship", romance: +20, understanding: +20 }
                        ],
                        background: "climax"
                    },
                    ending_romance: {
                        text: "Six months later, Martinez joins the protest movement. You're still wearing the frog costume at your wedding.",
                        speaker: "Narrator",
                        dialogue: "\"Some love stories begin with tear gas and end with hope.\"",
                        ending: "True Love",
                        endingType: "best"
                    },
                    ending_transformation: {
                        text: "Martinez becomes a whistleblower, exposing police misconduct. You keep the frog costume as a reminder of the day everything changed.",
                        speaker: "Narrator",
                        dialogue: "\"Revolution sometimes wears an inflatable costume.\"",
                        ending: "Revolutionary",
                        endingType: "good"
                    },
                    ending_friendship: {
                        text: "You meet monthly for coffee, bridging two worlds. The frog costume hangs in Martinez's locker as a reminder.",
                        speaker: "Narrator",
                        dialogue: "\"Understanding is the first step toward change.\"",
                        ending: "Friendship",
                        endingType: "neutral"
                    }
                    // Add more story branches as needed
                };
            }

            start() {
                this.gameState = 'playing';
                this.currentChapter = 1;
                this.romance = 0;
                this.tension = 50;
                this.understanding = 0;
                this.currentStoryNode = 'start';
                this.visitedNodes.clear();

                this.updateUI();
                this.displayStoryNode(this.currentStoryNode);

                // Track game start
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_started', {
                        game: 'romanceSimulator'
                    });
                }
            }

            makeChoice(choiceIndex) {
                if (this.gameState !== 'playing') return;

                const currentNode = this.storyData[this.currentStoryNode];
                const choice = currentNode.choices[choiceIndex];

                // Apply stat changes
                if (choice.romance) this.romance = Math.max(0, Math.min(100, this.romance + choice.romance));
                if (choice.tension) this.tension = Math.max(0, Math.min(100, this.tension + choice.tension));
                if (choice.understanding) this.understanding = Math.max(0, Math.min(100, this.understanding + choice.understanding));

                // Add visual effects
                this.addSceneEffect(choice);

                // Move to next node
                this.currentStoryNode = choice.next;
                this.visitedNodes.add(this.currentStoryNode);

                // Check for chapter progression
                if (this.visitedNodes.size % 3 === 0) {
                    this.currentChapter++;
                }

                setTimeout(() => {
                    this.updateUI();
                    this.displayStoryNode(this.currentStoryNode);
                }, 1000);
            }

            displayStoryNode(nodeId) {
                const node = this.storyData[nodeId];
                if (!node) return;

                // Update background
                this.updateBackground(node.background);

                // Display text
                document.getElementById('storyText').textContent = node.text;

                // Display speaker and dialogue
                const speakerDiv = document.getElementById('characterSpeaking');
                if (node.dialogue) {
                    speakerDiv.innerHTML = `<strong>${node.speaker}:</strong> ${node.dialogue}`;
                } else {
                    speakerDiv.innerHTML = `<strong>${node.speaker}</strong>`;
                }

                // Check for ending
                if (node.ending) {
                    this.handleEnding(node);
                    return;
                }

                // Display choices
                this.displayChoices(node.choices);
            }

            displayChoices(choices) {
                const choiceContainer = document.getElementById('choiceButtons');
                choiceContainer.innerHTML = '';

                choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.textContent = choice.text;
                    button.onclick = () => this.makeChoice(index);
                    choiceContainer.appendChild(button);
                });
            }

            updateBackground(bgType) {
                const background = document.getElementById('romanceBackground');
                const backgrounds = {
                    protest: 'linear-gradient(135deg, #1a1a2e, #16213e)',
                    playful: 'linear-gradient(135deg, rgba(255,192,203,0.3), rgba(135,206,235,0.3))',
                    tense: 'linear-gradient(135deg, rgba(255,69,0,0.3), rgba(220,20,60,0.3))',
                    neutral: 'linear-gradient(135deg, rgba(128,128,128,0.2), rgba(169,169,169,0.2))',
                    romantic: 'linear-gradient(135deg, rgba(255,105,180,0.4), rgba(255,20,147,0.4))',
                    intimate: 'linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,165,0,0.2))',
                    breakthrough: 'linear-gradient(135deg, rgba(50,205,50,0.3), rgba(34,139,34,0.3))',
                    climax: 'linear-gradient(135deg, rgba(255,215,0,0.4), rgba(255,105,180,0.4))'
                };

                background.style.background = backgrounds[bgType] || backgrounds.neutral;
            }

            addSceneEffect(choice) {
                const effects = document.getElementById('sceneEffects');
                const effect = document.createElement('div');

                if (choice.romance > 0) {
                    effect.textContent = '💕';
                } else if (choice.understanding > 0) {
                    effect.textContent = '🤝';
                } else if (choice.tension > 0) {
                    effect.textContent = '⚡';
                } else {
                    effect.textContent = '✨';
                }

                effect.style.cssText = `
                    position: absolute;
                    font-size: 2rem;
                    animation: floatUp 2s ease-out forwards;
                    left: 50%;
                    top: 50%;
                    transform: translate(-50%, -50%);
                    pointer-events: none;
                    z-index: 10;
                `;

                effects.appendChild(effect);
                setTimeout(() => effect.remove(), 2000);
            }

            updateUI() {
                // Update stat bars
                document.getElementById('romanceLevel').style.width = `${this.romance}%`;
                document.getElementById('tensionLevel').style.width = `${this.tension}%`;
                document.getElementById('understandingLevel').style.width = `${this.understanding}%`;

                // Update stat values
                document.getElementById('romanceValue').textContent = `${this.romance}%`;
                document.getElementById('tensionValue').textContent = `${this.tension}%`;
                document.getElementById('understandingValue').textContent = `${this.understanding}%`;

                // Update chapter and ending
                document.getElementById('currentChapter').textContent = this.currentChapter;
                document.getElementById('currentEnding').textContent = this.calculateCurrentEnding();
            }

            calculateCurrentEnding() {
                if (this.romance >= 70 && this.understanding >= 60) return "True Love";
                if (this.understanding >= 70) return "Revolutionary";
                if (this.romance >= 50 && this.understanding >= 40) return "Friendship";
                if (this.tension >= 80) return "Conflict";
                return "Unknown";
            }

            handleEnding(node) {
                this.gameState = 'ended';

                // Update best ending if this is better
                const endingRanks = { "True Love": 4, "Revolutionary": 3, "Friendship": 2, "Conflict": 1 };
                const currentRank = endingRanks[node.ending] || 0;
                const bestRank = endingRanks[this.bestEnding] || 0;

                if (currentRank > bestRank) {
                    this.bestEnding = node.ending;
                    localStorage.setItem('romanceBestEnding', this.bestEnding);
                    document.getElementById('romanceHighScore').textContent = this.bestEnding;
                }

                // Track completion
                if (window.timelineSystem) {
                    window.timelineSystem.trackInteraction('game_completed', {
                        game: 'romanceSimulator',
                        ending: node.ending,
                        romance: this.romance,
                        understanding: this.understanding,
                        tension: this.tension,
                        isNewBest: currentRank > bestRank
                    });
                }

                // Display ending choices
                const choiceContainer = document.getElementById('choiceButtons');
                choiceContainer.innerHTML = `
                    <div style="text-align: center; margin: 20px 0;">
                        <h3>🎭 ${node.ending} Ending Achieved!</h3>
                        <p style="margin: 15px 0;">${node.dialogue}</p>
                    </div>
                    <button class="choice-btn" onclick="resetRomanceGame()">🔄 Play Again</button>
                    <button class="choice-btn" onclick="showRomanceProgress()">📊 View All Endings</button>
                `;
            }

            loadBestEnding() {
                document.getElementById('romanceHighScore').textContent = this.bestEnding;
            }
        }

        // Romance Simulator control functions
        function launchRomanceSimulator() {
            const modal = document.getElementById('romanceModal');
            modal.style.display = 'block';
            if (!window.romanceGame) {
                window.romanceGame = new RomanceSimulator();
            }

            // Add click-outside-to-close functionality
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeRomanceSimulator();
                }
            });
        }

        function closeRomanceSimulator() {
            document.getElementById('romanceModal').style.display = 'none';
            if (window.romanceGame) {
                window.romanceGame.gameState = 'stopped';
            }
        }

        function startRomanceGame() {
            if (window.romanceGame) {
                window.romanceGame.start();
            }
        }

        function resetRomanceGame() {
            if (window.romanceGame) {
                window.romanceGame.start();
            }
        }

        function showRomanceProgress() {
            // Show progress modal with all possible endings
            alert('Romance Progress: Track your different story paths and endings! (Coming in future update)');
        }

        function toggleRomanceMusic() {
            if (window.romanceGame) {
                window.romanceGame.musicEnabled = !window.romanceGame.musicEnabled;
                localStorage.setItem('romanceMusic', window.romanceGame.musicEnabled);
                // Music toggle implementation would go here
                alert(`Music ${window.romanceGame.musicEnabled ? 'enabled' : 'disabled'}`);
            }
        }

        // Add floating animation for scene effects
        const floatUpStyle = document.createElement('style');
        floatUpStyle.textContent = `
            @keyframes floatUp {
                0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
                50% { opacity: 1; transform: translate(-50%, -70%) scale(1); }
                100% { opacity: 0; transform: translate(-50%, -90%) scale(0.8); }
            }
        `;
        document.head.appendChild(floatUpStyle);

        // Initialize systems when page loads
        window.addEventListener('load', () => {
            // Initialize timeline system
            window.timelineSystem = new InteractiveTimeline();

            // Initialize meme generator
            window.memeGenerator = new MemeGenerator();

            // Initialize easter egg system
            window.easterEggSystem = new EasterEggSystem();

            // Check for reduced motion preference
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                new HeroParticleSystem();
                new StatsAnimator();
            } else {
                // Still initialize stats animator for basic functionality
                new StatsAnimator();
            }
        });
    </script>
</body>
</html>